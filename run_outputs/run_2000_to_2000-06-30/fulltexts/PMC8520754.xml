<?xml version="1.0"  ?><!DOCTYPE pmc-articleset PUBLIC "-//NLM//DTD ARTICLE SET 2.0//EN" "https://dtd.nlm.nih.gov/ncbi/pmc/articleset/nlm-articleset-2.0.dtd"><pmc-articleset><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" id="psp412689" xml:lang="en" article-type="research-article" dtd-version="1.4"><processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats"><restricted-by>pmc</restricted-by></processing-meta><front><journal-meta><journal-id journal-id-type="nlm-ta">CPT Pharmacometrics Syst Pharmacol</journal-id><journal-id journal-id-type="iso-abbrev">CPT Pharmacometrics Syst Pharmacol</journal-id><journal-id journal-id-type="pmc-domain-id">2038</journal-id><journal-id journal-id-type="pmc-domain">cptpsp</journal-id><journal-id journal-id-type="publisher-id">PSP4</journal-id><journal-title-group><journal-title>CPT: Pharmacometrics &amp; Systems Pharmacology</journal-title></journal-title-group><issn pub-type="epub">2163-8306</issn><publisher><publisher-name>Wiley</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">PMC8520754</article-id><article-id pub-id-type="pmcid-ver">PMC8520754.1</article-id><article-id pub-id-type="pmcaid">8520754</article-id><article-id pub-id-type="pmcaiid">8520754</article-id><article-id pub-id-type="pmid">34342170</article-id><article-id pub-id-type="doi">10.1002/psp4.12689</article-id><article-id pub-id-type="publisher-id">PSP412689</article-id><article-version article-version-type="pmc-version">1</article-version><article-categories><subj-group subj-group-type="overline"><subject>Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Research</subject><subj-group subj-group-type="heading"><subject>Articles</subject></subj-group></subj-group></article-categories><title-group><article-title>Easy and reliable maximum <italic toggle="no">a posteriori</italic> Bayesian estimation of pharmacokinetic parameters with the open&#8208;source R package mapbayr</article-title><alt-title alt-title-type="right-running-head">PK PARAMETERS BAYESIAN ESTIMATION IN R</alt-title><alt-title alt-title-type="left-running-head">LE LOUEDEC et al.</alt-title></title-group><contrib-group><contrib id="psp412689-cr-0001" contrib-type="author"><name name-style="western"><surname>Le Louedec</surname><given-names initials="F">F&#233;licien</given-names></name><contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-3699-2729</contrib-id><xref rid="psp412689-aff-0001" ref-type="aff">
<sup>1</sup>
</xref><xref rid="psp412689-aff-0002" ref-type="aff">
<sup>2</sup>
</xref><xref rid="psp412689-aff-0003" ref-type="aff">
<sup>3</sup>
</xref></contrib><contrib id="psp412689-cr-0002" contrib-type="author"><name name-style="western"><surname>Puisset</surname><given-names initials="F">Florent</given-names></name><contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-3083-5784</contrib-id><xref rid="psp412689-aff-0001" ref-type="aff">
<sup>1</sup>
</xref><xref rid="psp412689-aff-0002" ref-type="aff">
<sup>2</sup>
</xref><xref rid="psp412689-aff-0003" ref-type="aff">
<sup>3</sup>
</xref></contrib><contrib id="psp412689-cr-0003" contrib-type="author"><name name-style="western"><surname>Thomas</surname><given-names initials="F">Fabienne</given-names></name><contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-9886-412X</contrib-id><xref rid="psp412689-aff-0001" ref-type="aff">
<sup>1</sup>
</xref><xref rid="psp412689-aff-0002" ref-type="aff">
<sup>2</sup>
</xref><xref rid="psp412689-aff-0003" ref-type="aff">
<sup>3</sup>
</xref></contrib><contrib id="psp412689-cr-0004" contrib-type="author" corresp="yes"><name name-style="western"><surname>Chatelut</surname><given-names initials="&#xC9;">&#201;tienne</given-names></name><contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-7740-9096</contrib-id><xref rid="psp412689-aff-0001" ref-type="aff">
<sup>1</sup>
</xref><xref rid="psp412689-aff-0002" ref-type="aff">
<sup>2</sup>
</xref><xref rid="psp412689-aff-0003" ref-type="aff">
<sup>3</sup>
</xref><address><email>chatelut.etienne@iuct-oncopole.fr</email></address></contrib><contrib id="psp412689-cr-0005" contrib-type="author"><name name-style="western"><surname>White&#8208;Koning</surname><given-names initials="M">M&#233;lanie</given-names></name><contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-5072-5489</contrib-id><xref rid="psp412689-aff-0001" ref-type="aff">
<sup>1</sup>
</xref><xref rid="psp412689-aff-0002" ref-type="aff">
<sup>2</sup>
</xref></contrib></contrib-group><aff id="psp412689-aff-0001">
<label>
<sup>1</sup>
</label>
<named-content content-type="organisation-division">Inserm UMR1037</named-content>
<institution>Cancer Research Center of Toulouse</institution>
<city>Toulouse</city>
<country country="FR">France</country>
</aff><aff id="psp412689-aff-0002">
<label>
<sup>2</sup>
</label>
<named-content content-type="organisation-division">Faculty of Pharmacy</named-content>
<institution>Universit&#233; Paul Sabatier Toulouse III</institution>
<city>Toulouse</city>
<country country="FR">France</country>
</aff><aff id="psp412689-aff-0003">
<label>
<sup>3</sup>
</label>
<named-content content-type="organisation-division">Institut Claudius&#8208;Regaud</named-content>
<institution>Institut Universitaire du Cancer de Toulouse&#8211;Oncopole</institution>
<city>Toulouse</city>
<country country="FR">France</country>
</aff><author-notes><corresp id="correspondenceTo"><label>*</label><bold>Correspondence</bold><break/>
&#201;tienne Chatelut, Institut Universitaire du Cancer Toulouse&#8211;Oncopole, 1 avenue Ir&#232;ne Joliot&#8208;Curie, 31059 Toulouse Cedex 9, France.<break/>
Email: <email>chatelut.etienne@iuct-oncopole.fr</email><break/></corresp></author-notes><pub-date pub-type="epub"><day>08</day><month>9</month><year>2021</year></pub-date><pub-date pub-type="ppub"><month>10</month><year>2021</year></pub-date><volume>10</volume><issue seq="100">10</issue><issue-id pub-id-type="pmc-issue-id">392015</issue-id><issue-id pub-id-type="doi">10.1002/psp4.v10.10</issue-id><fpage>1208</fpage><lpage>1220</lpage><history><date date-type="rev-recd"><day>22</day><month>6</month><year>2021</year></date><date date-type="received"><day>04</day><month>5</month><year>2021</year></date><date date-type="accepted"><day>28</day><month>6</month><year>2021</year></date></history><pub-history><event event-type="pmc-release"><date><day>01</day><month>10</month><year>2021</year></date></event><event event-type="pmc-live"><date><day>25</day><month>10</month><year>2021</year></date></event><event event-type="pmc-last-change"><date iso-8601-date="2021-10-26 00:16:37.593"><day>26</day><month>10</month><year>2021</year></date></event></pub-history><permissions><copyright-statement content-type="article-copyright">&#169; 2021 The Authors. <italic toggle="yes">CPT: Pharmacometrics &amp; Systems Pharmacology</italic> published by Wiley Periodicals LLC on behalf of American Society for Clinical Pharmacology and Therapeutics.</copyright-statement><license><ali:license_ref specific-use="textmining" content-type="ccbyncndlicense">https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref><license-p>This is an open access article under the terms of the <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc-nd/4.0/">http://creativecommons.org/licenses/by-nc-nd/4.0/</ext-link> License, which permits use and distribution in any medium, provided the original work is properly cited, the use is non&#8208;commercial and no modifications or adaptations are made.</license-p></license></permissions><self-uri xmlns:xlink="http://www.w3.org/1999/xlink" content-type="pmc-pdf" xlink:href="PSP4-10-1208.pdf"/><self-uri xmlns:xlink="http://www.w3.org/1999/xlink" content-type="pdf" xlink:href="file:PSP4-10-1208.pdf"/><abstract id="psp412689-abs-0001"><title>Abstract</title><p>Pharmacokinetic (PK) parameter estimation is a critical and complex step in the model&#8208;informed precision dosing (MIPD) approach. The mapbayr package was developed to perform maximum <italic toggle="yes">a posteriori</italic> Bayesian estimation (MAP&#8208;BE) in R from any population PK model coded in mrgsolve. The performances of mapbayr were assessed using two approaches. First, &#8220;test&#8221; models with different features were coded, for example, first&#8208;order and zero&#8208;order absorption, lag time, time&#8208;varying covariates, Michaelis&#8211;Menten elimination, combined and exponential residual error, parent drug and metabolite, and small or large inter&#8208;individual variability (IIV). A total of 4000 PK profiles (combining single/multiple dosing and rich/sparse sampling) were simulated from each test model, and MAP&#8208;BE of parameters was performed in both mapbayr and NONMEM. Second, a similar procedure was conducted with seven &#8220;real&#8221; previously published models to compare mapbayr and NONMEM on a PK outcome used in MIPD. For the test models, 98% of mapbayr estimations were identical to those given by NONMEM. Some discordances could be observed when dose&#8208;related parameters were estimated or when models with large IIV were used. The exploration of objective function values suggested that mapbayr might outdo NONMEM in specific cases. For the real models, a concordance close to 100% on PK outcomes was observed. The mapbayr package provides a reliable solution to perform MAP&#8208;BE of PK parameters in R. It also includes functions dedicated to data formatting and reporting and enables the creation of standalone Shiny web applications dedicated to MIPD, whatever the model or the clinical protocol and without additional software other than R.</p></abstract><counts><fig-count count="4"/><table-count count="3"/><page-count count="13"/><word-count count="7809"/></counts><custom-meta-group><custom-meta><meta-name>pmc-status-qastatus</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>pmc-status-live</meta-name><meta-value>yes</meta-value></custom-meta><custom-meta><meta-name>pmc-status-embargo</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-status-released</meta-name><meta-value>yes</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-open-access</meta-name><meta-value>yes</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-olf</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-manuscript</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-legally-suppressed</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-has-pdf</meta-name><meta-value>yes</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-has-supplement</meta-name><meta-value>yes</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-pdf-only</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-suppress-copyright</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-is-real-version</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-is-scanned-article</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-preprint</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-in-epmc</meta-name><meta-value>yes</meta-value></custom-meta><custom-meta><meta-name>source-schema-version-number</meta-name><meta-value>2.0</meta-value></custom-meta><custom-meta><meta-name>cover-date</meta-name><meta-value>October 2021</meta-value></custom-meta><custom-meta><meta-name>details-of-publishers-convertor</meta-name><meta-value>Converter:WILEY_ML3GV2_TO_JATSPMC version:6.0.8 mode:remove_FC converted:17.10.2021</meta-value></custom-meta></custom-meta-group></article-meta><notes><p content-type="self-citation">
<mixed-citation publication-type="journal" id="psp412689-cit-1001"><string-name name-style="western"><surname>Le Louedec</surname><given-names>F</given-names></string-name>, <string-name name-style="western"><surname>Puisset</surname><given-names>F</given-names></string-name>, <string-name name-style="western"><surname>Thomas</surname><given-names>F</given-names></string-name>, <string-name name-style="western"><surname>Chatelut</surname><given-names>&#201;</given-names></string-name>, <string-name name-style="western"><surname>White&#8208;Koning</surname><given-names>M</given-names></string-name>. <article-title>Easy and reliable maximum <italic toggle="no">a posteriori</italic> Bayesian estimation of pharmacokinetic parameters with the open&#8208;source R package mapbayr</article-title>. <source>CPT Pharmacometrics Syst Pharmacol</source>. <year>2021</year>;<volume>10</volume>:<fpage>1208</fpage>&#8211;<lpage>1220</lpage>. <pub-id pub-id-type="doi">10.1002/psp4.12689</pub-id><pub-id pub-id-type="pmcid">PMC8520754</pub-id><pub-id pub-id-type="pmid">34342170</pub-id></mixed-citation>
</p><fn-group id="psp412689-ntgp-0001"><fn fn-type="funding" id="psp412689-note-0001"><p>
<bold>Funding information</bold>
</p><p>No funding was received for this work.</p></fn></fn-group></notes></front><body id="psp412689-body-0001"><p>
<boxed-text position="anchor" content-type="box" id="psp412689-blkfxd-0001" orientation="portrait"><caption><title>Study Highlights</title></caption><p>
<list list-type="simple" id="psp412689-list-0001"><list-item><p>
<bold>WHAT IS THE CURRENT KNOWLEDGE ON THE TOPIC?</bold>
</p></list-item></list>
</p><p>There are currently no resources dedicated to maximum <italic toggle="yes">a posteriori</italic> Bayesian estimation (MAP&#8208;BE) of pharmacokinetic (PK) parameters in R to perform model&#8208;informed precision dosing (MIPD) in a Shiny web application.
<list list-type="simple" id="psp412689-list-0002"><list-item><p>
<bold>WHAT QUESTION DID THIS STUDY ADDRESS?</bold>
</p></list-item></list>
</p><p>Are the PK parameter estimates provided by mapbayr, a free, open&#8208;source R package dedicated to MAP&#8208;BE, reliable as compared with the gold&#8208;standard NONMEM?
<list list-type="simple" id="psp412689-list-0003"><list-item><p>
<bold>WHAT DOES THIS STUDY ADD TO OUR KNOWLEDGE?</bold>
</p></list-item></list>
</p><p>About 98% of the estimates returned by mapbayr were identical to NONMEM&#8217;s among a wide variety of test models. The exploration of the objective function values in discordant situations suggests that mapbayr could outdo NONMEM in certain specific situations.
<list list-type="simple" id="psp412689-list-0004"><list-item><p>
<bold>HOW MIGHT THIS CHANGE DRUG DISCOVERY, DEVELOPMENT, AND/OR THERAPEUTICS?</bold>
</p></list-item></list>
</p><p>Along with the other functions implemented in mapbayr, the reliable MAP&#8208;BE of parameters from any kind of simple or complex PK model can be done in R and implemented into a standard R framework such as Shiny web applications dedicated to MIPD.</p></boxed-text>
</p><sec id="psp412689-sec-0002"><title>INTRODUCTION</title><p>Therapeutic drug monitoring (TDM) consists in measuring plasma or blood drug concentration(s) to guide dose adaptation (if required) with the ultimate aim of improving efficacy and/or tolerance.<xref rid="psp412689-bib-0001" ref-type="bibr">
<sup>1</sup>
</xref>, <xref rid="psp412689-bib-0002" ref-type="bibr">
<sup>2</sup>
</xref> In many situations, the dose recommendation cannot rely solely on the measure of drug concentration(s) but is improved by an analysis based on a preexisting pharmacokinetic (PK) model. For some drugs, it may be necessary to compute an area under the curve of concentrations versus time (AUC) from a limited number of samples to quantify drug exposure.<xref rid="psp412689-bib-0003" ref-type="bibr">
<sup>3</sup>
</xref>, <xref rid="psp412689-bib-0004" ref-type="bibr">
<sup>4</sup>
</xref>, <xref rid="psp412689-bib-0005" ref-type="bibr">
<sup>5</sup>
</xref>, <xref rid="psp412689-bib-0006" ref-type="bibr">
<sup>6</sup>
</xref> For other therapeutics, such as intravenous antibiotics, model&#8208;informed precision dosing (MIPD) approaches have been developed to refine dosing schedules and maintain drug concentrations over minimal inhibitory concentrations.<xref rid="psp412689-bib-0007" ref-type="bibr">
<sup>7</sup>
</xref>
</p><p>All of these approaches rely on the maximum <italic toggle="yes">a posteriori</italic> Bayesian estimation (MAP&#8208;BE) of individual PK parameters from a population PK model. Population PK analysis establishes a model to quantify and explain the variability in drug concentrations from a set of individuals and is frequently used to guide drug development and inform recommendations on dose individualization. MAP&#8208;BE relies on this <italic toggle="yes">a priori</italic> parameter distribution provided by the population PK model to estimate the most likely PK parameters for one individual given a set of patient&#8208;related data (i.e., observed concentrations and covariates). An individualized dose can then be calculated based on the patient's <italic toggle="yes">a posteriori</italic> parameters. This approach was conceptualized nearly 50 years ago by Sheiner et al.<xref rid="psp412689-bib-0008" ref-type="bibr">
<sup>8</sup>
</xref> and led to the development of the NONMEM software, which is currently the gold standard to build population PK models and, among other applications, to perform MAP&#8208;BE.<xref rid="psp412689-bib-0009" ref-type="bibr">
<sup>9</sup>
</xref>
</p><p>Ready&#8208;to&#8208;use MIPD software are available for dose adaptation with a MAP&#8208;BE approach.<xref rid="psp412689-bib-0010" ref-type="bibr">
<sup>10</sup>
</xref>, <xref rid="psp412689-bib-0011" ref-type="bibr">
<sup>11</sup>
</xref>, <xref rid="psp412689-bib-0012" ref-type="bibr">
<sup>12</sup>
</xref> Although these may be satisfactory in many situations, drawbacks limit their use: libraries limited to specific drugs, no possibility to define specific protocols, and cost.<xref rid="psp412689-bib-0013" ref-type="bibr">
<sup>13</sup>
</xref> Although the benefit of a model&#8208;based TDM approach is expected in areas other than antibiotics, such as antiepileptics<xref rid="psp412689-bib-0014" ref-type="bibr">
<sup>14</sup>
</xref> or anticancer drugs,<xref rid="psp412689-bib-0015" ref-type="bibr">
<sup>15</sup>
</xref> these are often missing from MIPD software. Hospital pharmacists or biologists could perform MAP&#8208;BE with in&#8208;house models and data directly inputted within NONMEM, but this is not convenient nor safe for routine use.</p><p>One approach could be to use R through in&#8208;house Shiny web applications. R is a free software and a programming language<xref rid="psp412689-bib-0016" ref-type="bibr">
<sup>16</sup>
</xref> increasingly used in the pharmacometrics community for a broad variety of tasks such as statistical analysis, data visualization, and reporting. With the Shiny package, it is possible to code a web interface to execute R tasks in the background using R code only<xref rid="psp412689-bib-0017" ref-type="bibr">
<sup>17</sup>
</xref> without prior knowledge of a web language (such as HTML, CSS, or Javascript). Shiny is well documented online and broadly used in the field of pharmacometrics and beyond,<xref rid="psp412689-bib-0018" ref-type="bibr">
<sup>18</sup>
</xref>, <xref rid="psp412689-bib-0019" ref-type="bibr">
<sup>19</sup>
</xref> which makes it possible for anyone with basic R coding skills to build his/her own Shiny application and, for example, safely perform TDM. A remarkable example of such an application is TDMx<xref rid="psp412689-bib-0020" ref-type="bibr">
<sup>20</sup>
</xref>; however, its use is limited to antibiotics, and the source code is not published, preventing its generalization to other drugs.</p><p>Existing R packages nlmixr<xref rid="psp412689-bib-0021" ref-type="bibr">
<sup>21</sup>
</xref> and saemix<xref rid="psp412689-bib-0022" ref-type="bibr">
<sup>22</sup>
</xref> are dedicated to population PK/pharmacodynamics (PD) modeling from a data set of concentrations of several patients. Others, such as RxODE<xref rid="psp412689-bib-0023" ref-type="bibr">
<sup>23</sup>
</xref> and mrgsolve,<xref rid="psp412689-bib-0024" ref-type="bibr">
<sup>24</sup>
</xref>, <xref rid="psp412689-bib-0025" ref-type="bibr">
<sup>25</sup>
</xref> operate using user&#8208;defined population PK models but perform simulations and not estimations. Thus, we developed mapbayr, a free, open&#8208;source R package designed to estimate individual PK parameters of any population PK model defined by the user. Its objective is to facilitate model&#8208;based TDM by performing MAP&#8208;BE with a single function in R without any external nonlinear mixed effect modeling software. Model coding and ordinary differential equations (ODE) solving are based on mrgsolve, a versatile R package which uses syntax similar to NONMEM. Almost any PK or PK/PD model can be implemented in mrgsolve and thus should be useable with mapbayr. The latter is intended to be integrated into Shiny applications dedicated to TDM.</p><p>The objective of this study is to introduce mapbayr package features and to validate its performance in terms of parameter estimation compared with NONMEM.</p></sec><sec sec-type="methods" id="psp412689-sec-0003"><title>METHODS</title><sec id="psp412689-sec-0004"><title>MAP Bayesian estimation process</title><p>A population PK or PK/PD model can be defined by the following expressions.<disp-formula id="psp412689-disp-0001"><mml:math id="jats-math-1" display="block"><mml:mfenced close="" open="{" separators=""><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>F</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>&#952;</mml:mi><mml:mi>&#894;</mml:mi><mml:mspace width="0.166667em"/><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>&#894;</mml:mi><mml:msub><mml:mi>&#951;</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>&#951;</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>&#951;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mi>&#951;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mo>&#8943;</mml:mo><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mi>&#951;</mml:mi><mml:mi mathvariant="italic">ik</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>&#951;</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#8764;</mml:mo><mml:mi>M</mml:mi><mml:mi>V</mml:mi><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">&#937;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>Y</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:mi>&#894;</mml:mi><mml:mspace width="0.166667em"/><mml:msub><mml:mi>&#949;</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>&#949;</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:mo>&#8764;</mml:mo><mml:mi>M</mml:mi><mml:mi>V</mml:mi><mml:mi>N</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">&#931;</mml:mi></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:math></disp-formula>
</p><p>Here, <italic toggle="yes">F<sub>ij</sub>
</italic> is the <italic toggle="yes">j</italic>th prediction of the <italic toggle="yes">i</italic>th individual, <italic toggle="yes">f</italic> the structural model, <mml:math id="jats-math-2"><mml:mi>&#952;</mml:mi></mml:math> the vector of model parameters, <mml:math id="jats-math-3"><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math> the vector of covariates, <mml:math id="jats-math-4"><mml:msub><mml:mi>&#951;</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math> the vector (of length <italic toggle="yes">k</italic>) of individual parameters <mml:math id="jats-math-5"><mml:msub><mml:mi>&#951;</mml:mi><mml:mi mathvariant="italic">ik</mml:mi></mml:msub><mml:mspace width="0.166667em"/></mml:math> and <mml:math id="jats-math-6"><mml:mrow><mml:mi mathvariant="normal">&#937;</mml:mi><mml:mspace width="0.166667em"/></mml:mrow></mml:math> is the variance&#8211;covariance matrix of the multivariate normal distribution (<italic toggle="yes">MVN</italic>) of <mml:math id="jats-math-7"><mml:mrow><mml:mspace width="0.166667em"/><mml:msub><mml:mi>&#951;</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math>, also referred to as the inter&#8208;individual variability (IIV) of the model parameters. On the diagonal of <mml:math id="jats-math-8"><mml:mrow><mml:mi mathvariant="normal">&#937;</mml:mi><mml:mspace width="0.166667em"/></mml:mrow></mml:math> are <mml:math id="jats-math-9"><mml:mrow><mml:mi>k</mml:mi><mml:mspace width="0.166667em"/></mml:mrow></mml:math> variances <mml:math id="jats-math-10"><mml:msubsup><mml:mi>&#969;</mml:mi><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math>. The vector of observations (<mml:math id="jats-math-11"><mml:msub><mml:mi>Y</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub></mml:math>) is defined with a residual error model (<mml:math id="jats-math-12"><mml:mi>h</mml:mi></mml:math>), where <mml:math id="jats-math-13"><mml:msub><mml:mi>&#949;</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub></mml:math> is the residual error term and <mml:math id="jats-math-14"><mml:mrow><mml:mi mathvariant="normal">&#931;</mml:mi><mml:mspace width="0.166667em"/></mml:mrow></mml:math> is the variance&#8211;covariance matrix of the <italic toggle="yes">MVN</italic> distribution of <mml:math id="jats-math-15"><mml:msub><mml:mi>&#949;</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub></mml:math>, also referred to as intraindividual variability or residual error on the dependent variable. In the context of MAP&#8208;BE, <mml:math id="jats-math-16"><mml:mrow><mml:mi>&#952;</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">&#937;</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/></mml:mrow></mml:math> and <mml:math id="jats-math-17"><mml:mrow><mml:mi mathvariant="normal">&#931;</mml:mi><mml:mspace width="0.166667em"/></mml:mrow></mml:math> are fixed (considered &#8220;true&#8221;) population parameters, and <mml:math id="jats-math-18"><mml:msub><mml:mi>&#951;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mspace width="0.166667em"/></mml:mrow></mml:msub></mml:math> and <mml:math id="jats-math-19"><mml:mrow><mml:msub><mml:mi>&#949;</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:mspace width="0.166667em"/></mml:mrow></mml:math> are random variables to be estimated. The estimate of <mml:math id="jats-math-20"><mml:msub><mml:mi>&#951;</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math>, <mml:math id="jats-math-21"><mml:msub><mml:mover accent="true"><mml:mi>&#951;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math>, is also referred to as empirical Bayesian estimates or post hoc values in the NONMEM framework. In the first&#8208;order conditional estimation with interaction procedure, it is defined as the argument that will minimize an objective function value (<mml:math id="jats-math-22"><mml:msub><mml:mi mathvariant="normal">OFV</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math>), which provides information on the likelihood (LL) of <mml:math id="jats-math-23"><mml:msub><mml:mi>&#951;</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math>
<xref rid="psp412689-bib-0026" ref-type="bibr">
<sup>26</sup>
</xref>:<disp-formula id="psp412689-disp-0002"><mml:math id="jats-math-24" display="block"><mml:mrow><mml:msub><mml:mi mathvariant="normal">OFV</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>O</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mi>&#951;</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:mo>&#8208;</mml:mo><mml:mn>2</mml:mn><mml:mi mathvariant="normal">LL</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mi>&#951;</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mo>&#8721;</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mfenced close="]" open="[" separators=""><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mspace width="0.166667em"/><mml:msubsup><mml:mi>&#963;</mml:mi><mml:mi mathvariant="italic">ij</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mspace width="0.166667em"/><mml:mfrac><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mi>Y</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:mo>&#8208;</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub></mml:mfenced></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mi>&#963;</mml:mi><mml:mi mathvariant="italic">ij</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mfrac></mml:mfenced><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mi>&#951;</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mi mathvariant="normal">&#937;</mml:mi><mml:mrow><mml:mo>&#8208;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mi>&#951;</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
<disp-formula id="psp412689-disp-0003"><mml:math id="jats-math-25" display="block"><mml:msub><mml:mover accent="true"><mml:mi>&#951;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>argmin</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>O</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mi>&#951;</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math></disp-formula>
</p><p>Here, <mml:math id="jats-math-26"><mml:msubsup><mml:mi>&#963;</mml:mi><mml:mi mathvariant="italic">ij</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math> is the matrix multiplication of the H matrix, the <mml:math id="jats-math-27"><mml:mi mathvariant="normal">&#931;</mml:mi></mml:math> matrix, and the transpose of H matrix, where H represents the partial derivatives of <mml:math id="jats-math-28"><mml:msub><mml:mi>Y</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub></mml:math> according to <mml:math id="jats-math-29"><mml:msub><mml:mi>&#949;</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub></mml:math>.<xref rid="psp412689-bib-0027" ref-type="bibr">
<sup>27</sup>
</xref>, <xref rid="psp412689-bib-0028" ref-type="bibr">
<sup>28</sup>
</xref>
</p></sec><sec id="psp412689-sec-0005"><title>mapbayr estimation workflow</title><p>The same workflow is followed within mapbayr (Figure&#160;<xref rid="psp412689-fig-0001" ref-type="fig">1</xref>). The feasibility of this transposition to R has previously been suggested.<xref rid="psp412689-bib-0029" ref-type="bibr">
<sup>29</sup>
</xref> Predictions (<mml:math id="jats-math-30"><mml:msub><mml:mi>F</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub></mml:math>) are computed based on information available in the model code (parameter values, ODE) and data (dosing and covariates) using the mrgsolve differential equation solver. The latter is a C++ implementation of LSODA, a solver for stiff and nonstiff differential equations, equivalent to the LSODA solver implemented in NONMEM in the subroutine ADVAN 13.<xref rid="psp412689-bib-0030" ref-type="bibr">
<sup>30</sup>
</xref> The OFV can be computed using observations (<mml:math id="jats-math-31"><mml:msub><mml:mi>Y</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub></mml:math>) from the data set and <mml:math id="jats-math-32"><mml:mi mathvariant="normal">&#937;</mml:mi></mml:math> and <mml:math id="jats-math-33"><mml:mi mathvariant="normal">&#931;</mml:mi></mml:math> matrices defined in the model code. Finally, OFV is minimized by optimizing <mml:math id="jats-math-34"><mml:msub><mml:mi>&#951;</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math> using the limited&#8208;memory Broyden&#8211;Fletcher&#8211;Goldfarb&#8211;Shanno with box constraints (L&#8208;BFGS&#8208;B) algorithm implemented in the optimx package in R.<xref rid="psp412689-bib-0031" ref-type="bibr">
<sup>31</sup>
</xref> Additional details about L&#8208;BFGS&#8208;B specifications are provided in the <xref rid="psp412689-sup-0002" ref-type="supplementary-material">Supplementary Materials</xref>.</p><fig position="float" fig-type="FIGURE" id="psp412689-fig-0001" orientation="portrait"><label>FIGURE 1</label><caption><p>Workflow of a Shiny web app to perform therapeutic drug monitoring with maximum <italic toggle="yes">a posteriori</italic> Bayesian estimation performed by mapbayr. Data format, parameter estimation, and estimation report are common whatever the drug and can be assumed by mapbayr functions (in blue). Computation of a specific <italic toggle="yes">a posteriori</italic> outcome and forecast of a dose adaptation is specific to the drug or protocol (in green). Arguments can be passed through a Shiny app (in red) so that the user enters information through a convenient interface. MAP, maximum <italic toggle="yes">a posteriori</italic>; PK, pharmacokinetics</p></caption><graphic xmlns:xlink="http://www.w3.org/1999/xlink" position="anchor" id="jats-graphic-1" orientation="portrait" xlink:href="PSP4-10-1208-g001.jpg"/></fig></sec><sec id="psp412689-sec-0006"><title>Validation process</title><p>The validation process consisted of comparing the <mml:math id="jats-math-35"><mml:msub><mml:mi>&#951;</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math> estimations given by NONMEM and mapbayr for a large number of simulated patients, with a wide variety of models, dosing schedules, and sampling procedures.</p><sec id="psp412689-sec-0007"><title>Test models</title><p>A total of 35 test models were investigated as summarized in Table&#160;<xref rid="psp412689-tbl-0001" ref-type="table">1</xref>. The default model was a monocompartmental model with first&#8208;order absorption and elimination. The IIV was set as log&#8208;normal with <mml:math id="jats-math-36"><mml:msubsup><mml:mi>&#969;</mml:mi><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math>&#160;=&#160;0.2 on three parameters (and thus as many estimated <mml:math id="jats-math-37"><mml:msub><mml:mi>&#951;</mml:mi><mml:mi mathvariant="italic">ik</mml:mi></mml:msub></mml:math> per individual): absorption rate constant (KA), volume of distribution (V), and clearance (CL). Residual error was coded as 20% proportional. The other models were derived from the default one, with additional estimation of parameters related to absorption (lag time, zero&#8208;order infusion duration, and bioavailability), distribution (peripheral volume), or elimination (Michaelis&#8211;Menten constant [K<sub>M</sub>] and maximum rate [<italic toggle="yes">V</italic>
<sub>MAX</sub>]). A model with time&#8208;varying covariates was explored. Different residual error models were investigated (proportional, additive, mixed, and log&#8208;additive) as well as simultaneously fitting two types of dependent variables (i.e., parent and metabolite). Finally, small or large values of IIV were tested (with <mml:math id="jats-math-38"><mml:msubsup><mml:mi>&#969;</mml:mi><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math> ranging from 0.2 to 1 for every parameter) as well as very large IIV (<mml:math id="jats-math-39"><mml:msubsup><mml:mi>&#969;</mml:mi><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math>&#160;=&#160;2) on one or multiple parameters. When applicable, all of these models were duplicated to allow for the administration either into a depot compartment (i.e., oral dosing) or in the central compartment (1&#8208;h intravenous infusion).</p><table-wrap position="float" id="psp412689-tbl-0001" content-type="TABLE" orientation="portrait"><label>TABLE 1</label><caption><p>Test models description</p></caption><table frame="hsides" rules="groups"><col style="border-right:solid 1px #000000" span="1"/><col style="border-right:solid 1px #000000" span="1"/><col style="border-right:solid 1px #000000" span="1"/><col style="border-right:solid 1px #000000" span="1"/><col style="border-right:solid 1px #000000" span="1"/><thead valign="top"><tr style="border-bottom:solid 1px #000000"><th align="left" colspan="2" valign="top" rowspan="1">Model</th><th align="left" valign="top" rowspan="1" colspan="1">Dosing</th><th align="left" valign="top" rowspan="1" colspan="1">Estimated parameters</th><th align="left" valign="top" rowspan="1" colspan="1">Model <italic toggle="yes">n</italic>&#176;</th></tr></thead><tbody><tr><td align="left" rowspan="2" colspan="2">Monocompartmental (default)</td><td align="left" rowspan="1" colspan="1">Oral</td><td align="left" rowspan="1" colspan="1">KA, CL, VC</td><td align="char" char="." rowspan="1" colspan="1">1</td></tr><tr><td align="left" rowspan="1" colspan="1">i.v. 1 h</td><td align="left" rowspan="1" colspan="1">(KA), CL, VC</td><td align="char" char="." rowspan="1" colspan="1">2</td></tr><tr><td align="left" rowspan="6" colspan="1">Absorption</td><td align="left" rowspan="1" colspan="1">Lag time</td><td align="left" rowspan="1" colspan="1">Oral</td><td align="left" rowspan="1" colspan="1">KA, CL, VC, ALAG1</td><td align="char" char="." rowspan="1" colspan="1">3</td></tr><tr><td align="left" rowspan="1" colspan="1">Zero&#8208;order in Central compartment</td><td align="left" rowspan="1" colspan="1">Oral</td><td align="left" rowspan="1" colspan="1">CL, VC, D2</td><td align="char" char="." rowspan="1" colspan="1">4</td></tr><tr><td align="left" rowspan="1" colspan="1">Zero&#8208;order in Depot compartment</td><td align="left" rowspan="1" colspan="1">Oral</td><td align="left" rowspan="1" colspan="1">CL, VC, KA, D1</td><td align="char" char="." rowspan="1" colspan="1">5</td></tr><tr><td align="left" rowspan="1" colspan="1">Dual 0&#8208; and 1st orders (fixed FR)</td><td align="left" rowspan="1" colspan="1">Oral</td><td align="left" rowspan="1" colspan="1">CL, VC, KA, D2</td><td align="char" char="." rowspan="1" colspan="1">6</td></tr><tr><td align="left" rowspan="1" colspan="1">Dual 1st orders (fixed FR)</td><td align="left" rowspan="1" colspan="1">Oral</td><td align="left" rowspan="1" colspan="1">CL, VC, KA1, KA2</td><td align="char" char="." rowspan="1" colspan="1">7</td></tr><tr><td align="left" rowspan="1" colspan="1">Bioavailability</td><td align="left" rowspan="1" colspan="1">Oral</td><td align="left" rowspan="1" colspan="1">CL, VC, KA, F (logit)</td><td align="char" char="." rowspan="1" colspan="1">8</td></tr><tr><td align="left" rowspan="2" colspan="1">Distribution</td><td align="left" rowspan="2" colspan="1">Bicompartmental</td><td align="left" rowspan="1" colspan="1">Oral</td><td align="left" rowspan="1" colspan="1">KA, CL, VC, VP</td><td align="char" char="." rowspan="1" colspan="1">101</td></tr><tr><td align="left" rowspan="1" colspan="1">i.v. 1 h</td><td align="left" rowspan="1" colspan="1">(KA), CL, VC, VP</td><td align="char" char="." rowspan="1" colspan="1">102</td></tr><tr><td align="left" rowspan="8" colspan="1">Elimination</td><td align="left" rowspan="2" colspan="1">Michaelis&#8211;Menten (K<sub>M</sub>, V<sub>MAX</sub>)</td><td align="left" rowspan="1" colspan="1">Oral</td><td align="left" rowspan="1" colspan="1">KA, VC, K<sub>M</sub>, V<sub>MAX</sub>
</td><td align="char" char="." rowspan="1" colspan="1">201</td></tr><tr><td align="left" rowspan="1" colspan="1">i.v. 1 h</td><td align="left" rowspan="1" colspan="1">(KA), VC, K<sub>M</sub>, V<sub>MAX</sub>
</td><td align="char" char="." rowspan="1" colspan="1">202</td></tr><tr><td align="left" rowspan="2" colspan="1">CL + Michaelis&#8211;Menten (K<sub>M</sub>)</td><td align="left" rowspan="1" colspan="1">Oral</td><td align="left" rowspan="1" colspan="1">KA, CL, VC, K<sub>M</sub>
</td><td align="char" char="." rowspan="1" colspan="1">203</td></tr><tr><td align="left" rowspan="1" colspan="1">i.v. 1 h</td><td align="left" rowspan="1" colspan="1">(KA), CL, VC, K<sub>M</sub>
</td><td align="char" char="." rowspan="1" colspan="1">204</td></tr><tr><td align="left" rowspan="2" colspan="1">CL + Michaelis&#8211;Menten (V<sub>MAX</sub>)</td><td align="left" rowspan="1" colspan="1">Oral</td><td align="left" rowspan="1" colspan="1">KA, CL, VC, V<sub>MAX</sub>
</td><td align="char" char="." rowspan="1" colspan="1">205</td></tr><tr><td align="left" rowspan="1" colspan="1">i.v. 1 h</td><td align="left" rowspan="1" colspan="1">(KA), CL, VC, V<sub>MAX</sub>
</td><td align="char" char="." rowspan="1" colspan="1">206</td></tr><tr><td align="left" rowspan="2" colspan="1">CL + Michaelis&#8211;Menten (K<sub>M</sub>, V<sub>MAX</sub>)</td><td align="left" rowspan="1" colspan="1">Oral</td><td align="left" rowspan="1" colspan="1">KA, CL, VC, K<sub>M</sub>, V<sub>MAX</sub>
</td><td align="char" char="." rowspan="1" colspan="1">207</td></tr><tr><td align="left" rowspan="1" colspan="1">i.v. 1 h</td><td align="left" rowspan="1" colspan="1">(KA), CL, VC, K<sub>M</sub>, V<sub>MAX</sub>
</td><td align="char" char="." rowspan="1" colspan="1">208</td></tr><tr><td align="left" rowspan="2" colspan="1">Time&#8208;Varying Covariates</td><td align="left" rowspan="2" colspan="1">Time&#8208;varying CL</td><td align="left" rowspan="1" colspan="1">Oral</td><td align="left" rowspan="1" colspan="1">KA, CL, VC</td><td align="char" char="." rowspan="1" colspan="1">301</td></tr><tr><td align="left" rowspan="1" colspan="1">i.v. 1 h</td><td align="left" rowspan="1" colspan="1">(KA), CL, VC</td><td align="char" char="." rowspan="1" colspan="1">302</td></tr><tr><td align="left" rowspan="8" colspan="1">Residual Error Model</td><td align="left" rowspan="2" colspan="1">Metabolite</td><td align="left" rowspan="1" colspan="1">Oral</td><td align="left" rowspan="1" colspan="1">KA, CL, VC, CL<sub>met</sub>, VC<sub>met</sub>
</td><td align="char" char="." rowspan="1" colspan="1">401</td></tr><tr><td align="left" rowspan="1" colspan="1">i.v. 1 h</td><td align="left" rowspan="1" colspan="1">(KA), CL, VC, CL<sub>met</sub>, VC<sub>met</sub>
</td><td align="char" char="." rowspan="1" colspan="1">402</td></tr><tr><td align="left" rowspan="2" colspan="1">Additive</td><td align="left" rowspan="1" colspan="1">Oral</td><td align="left" rowspan="1" colspan="1">KA, CL, VC</td><td align="char" char="." rowspan="1" colspan="1">403</td></tr><tr><td align="left" rowspan="1" colspan="1">i.v. 1 h</td><td align="left" rowspan="1" colspan="1">(KA), CL, VC</td><td align="char" char="." rowspan="1" colspan="1">404</td></tr><tr><td align="left" rowspan="2" colspan="1">Mixed</td><td align="left" rowspan="1" colspan="1">Oral</td><td align="left" rowspan="1" colspan="1">KA, CL, VC</td><td align="char" char="." rowspan="1" colspan="1">405</td></tr><tr><td align="left" rowspan="1" colspan="1">i.v. 1 h</td><td align="left" rowspan="1" colspan="1">(KA), CL, VC</td><td align="char" char="." rowspan="1" colspan="1">406</td></tr><tr><td align="left" rowspan="2" colspan="1">Log&#8208;additive</td><td align="left" rowspan="1" colspan="1">Oral</td><td align="left" rowspan="1" colspan="1">KA, CL, VC</td><td align="char" char="." rowspan="1" colspan="1">407</td></tr><tr><td align="left" rowspan="1" colspan="1">i.v. 1 h</td><td align="left" rowspan="1" colspan="1">(KA), CL, VC</td><td align="char" char="." rowspan="1" colspan="1">408</td></tr><tr><td align="left" rowspan="7" colspan="1">Inter&#8208;individual Variability</td><td align="left" rowspan="1" colspan="1">0.4 (63%) on KA, CL, VC</td><td align="left" rowspan="1" colspan="1">Oral</td><td align="left" rowspan="1" colspan="1">KA, CL, VC</td><td align="char" char="." rowspan="1" colspan="1">501</td></tr><tr><td align="left" rowspan="1" colspan="1">0.6 (77%) on KA, CL, VC</td><td align="left" rowspan="1" colspan="1">Oral</td><td align="left" rowspan="1" colspan="1">KA, CL, VC</td><td align="char" char="." rowspan="1" colspan="1">502</td></tr><tr><td align="left" rowspan="1" colspan="1">0.8 (89%) on KA, CL, VC</td><td align="left" rowspan="1" colspan="1">Oral</td><td align="left" rowspan="1" colspan="1">KA, CL, VC</td><td align="char" char="." rowspan="1" colspan="1">503</td></tr><tr><td align="left" rowspan="1" colspan="1">1 (100%) on KA, CL, VC</td><td align="left" rowspan="1" colspan="1">Oral</td><td align="left" rowspan="1" colspan="1">KA, CL, VC</td><td align="char" char="." rowspan="1" colspan="1">504</td></tr><tr><td align="left" rowspan="1" colspan="1">2 on CL, 0.2 on KA, VC</td><td align="left" rowspan="1" colspan="1">Oral</td><td align="left" rowspan="1" colspan="1">KA, CL, VC</td><td align="char" char="." rowspan="1" colspan="1">511</td></tr><tr><td align="left" rowspan="1" colspan="1">2 on CL, KA, 0.2 on VC</td><td align="left" rowspan="1" colspan="1">Oral</td><td align="left" rowspan="1" colspan="1">KA, CL, VC</td><td align="char" char="." rowspan="1" colspan="1">512</td></tr><tr><td align="left" rowspan="1" colspan="1">2 (141%) on CL, KA, VC</td><td align="left" rowspan="1" colspan="1">Oral</td><td align="left" rowspan="1" colspan="1">KA, CL, VC</td><td align="char" char="." rowspan="1" colspan="1">513</td></tr></tbody></table><table-wrap-foot id="psp412689-ntgp-0002"><title>Note</title><fn id="psp412689-note-0002"><p>Non&#8208;identifiable KA estimated in intravenous administration context are in parentheses.</p></fn><fn id="psp412689-note-0003"><p>Abbreviations: ALAGx, lag time in compartment x; CL, clearance; CL<sub>met</sub>, clearance of metabolite; Dx, infusion rate in compartment x; F, bioavailability constant; FR, fraction in depot compartment; i.v. 1 h, intravenous 1&#8208;hour infusion; KA, absorption rate; K<sub>M</sub>, Michaelis&#8211;Menten constant; VC, central volume of distribution; VC<sub>met</sub>, central volume of metabolite; V<sub>MAX</sub>, maximum rate; VP, peripheral volume of distribution.</p></fn></table-wrap-foot><permissions><copyright-holder>John Wiley &amp; Sons, Ltd</copyright-holder></permissions></table-wrap><p>For each model, 4000 individuals were attributed random values of <mml:math id="jats-math-40"><mml:msub><mml:mi>&#951;</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math> and dispatched in four cohorts with a combination of administration (single or multiple dosing) and observation (sparse or rich sampling) schedules (Table&#160;<xref rid="psp412689-tbl-0002" ref-type="table">2</xref>). Doses of 10, 30, 60, 80 or 120&#160;mg were given in each cohort (i.e., 200 individuals per dose level). Concentrations were simulated in mrgsolve, and a random proportional error of 10% was added. Null concentrations were excluded from the analysis (MDV&#160;=&#160;1), and non&#8208;null concentrations lower than 0.1&#160;&#956;g/ml were censored to this value. An example of a model code (mapbayr and NONMEM) and associated data are provided in the <xref rid="psp412689-sup-0002" ref-type="supplementary-material">Supplementary Materials</xref>.</p><table-wrap position="float" id="psp412689-tbl-0002" content-type="TABLE" orientation="portrait"><label>TABLE 2</label><caption><p>Test data description</p></caption><table frame="hsides" rules="groups"><col style="border-right:solid 1px #000000" span="1"/><col style="border-right:solid 1px #000000" span="1"/><col style="border-right:solid 1px #000000" span="1"/><thead valign="top"><tr style="border-bottom:solid 1px #000000"><th align="left" valign="top" rowspan="1" colspan="1">Cohort</th><th align="left" valign="top" rowspan="1" colspan="1">Administration times</th><th align="left" valign="top" rowspan="1" colspan="1">Observations</th></tr></thead><tbody><tr><td align="left" rowspan="4" colspan="1">Single dose, rich sampling</td><td align="left" rowspan="4" colspan="1">0 h</td><td align="char" char="&#xB1;" rowspan="1" colspan="1">1&#160;&#177;&#160;0.5 h</td></tr><tr><td align="char" char="&#xB1;" rowspan="1" colspan="1">4&#160;&#177;&#160;1 h</td></tr><tr><td align="char" char="&#xB1;" rowspan="1" colspan="1">8&#160;&#177;&#160;2 h</td></tr><tr><td align="char" char="&#xB1;" rowspan="1" colspan="1">24&#160;&#177;&#160;6 h</td></tr><tr><td align="left" rowspan="1" colspan="1">Single dose, sparse sampling</td><td align="left" rowspan="1" colspan="1">0 h</td><td align="char" char="&#xB1;" rowspan="1" colspan="1">24&#160;&#177;&#160;10 h</td></tr><tr><td align="left" rowspan="4" colspan="1">Multiple doses, rich sampling</td><td align="left" rowspan="4" colspan="1">0, 72, 96, 120, 144, 168, 192 and 216 h</td><td align="char" char="&#xB1;" rowspan="1" colspan="1">215&#160;&#177;&#160;0.5 h</td></tr><tr><td align="char" char="&#xB1;" rowspan="1" colspan="1">217&#160;&#177;&#160;1 h</td></tr><tr><td align="char" char="&#xB1;" rowspan="1" colspan="1">220&#160;&#177;&#160;1 h</td></tr><tr><td align="char" char="&#xB1;" rowspan="1" colspan="1">224&#160;&#177;&#160;2 h</td></tr><tr><td align="left" rowspan="1" colspan="1">Multiple doses, sparse sampling</td><td align="left" rowspan="1" colspan="1">0, 72, 96, 120, 144, 168, 192 and 216 h</td><td align="char" char="&#xB1;" rowspan="1" colspan="1">240&#160;&#177;&#160;10 h</td></tr></tbody></table><permissions><copyright-holder>John Wiley &amp; Sons, Ltd</copyright-holder></permissions></table-wrap></sec><sec id="psp412689-sec-0008"><title>Real models</title><p>In addition to the test models, the performance of mapbayr was assessed on seven real models corresponding to published clinical studies for which a population PK model was developed and fully reported. They combine different features separately explored with test models. Data were generated in accordance with the drug administration schedules and sampling strategies used in the context of TDM with <italic toggle="yes">n</italic>&#160;=&#160;1000 individuals. In addition, a variable corresponding to the routinely monitored PK outcome was computed with both NONMEM and mapbayr: last dose of a 3&#8208;day schedule to reach a total AUC of 24&#160;mg&#183;min/ml for carboplatin<xref rid="psp412689-bib-0032" ref-type="bibr">
<sup>32</sup>
</xref>; AUC at steady state between two doses (AUC<sub>&#964;,SS</sub>) for ibrutinib<xref rid="psp412689-bib-0033" ref-type="bibr">
<sup>33</sup>
</xref>, <xref rid="psp412689-bib-0034" ref-type="bibr">
<sup>34</sup>
</xref>; trough concentration at steady state for cabozantinib,<xref rid="psp412689-bib-0035" ref-type="bibr">
<sup>35</sup>
</xref> pazopanib,<xref rid="psp412689-bib-0036" ref-type="bibr">
<sup>36</sup>
</xref> and voriconazole<xref rid="psp412689-bib-0037" ref-type="bibr">
<sup>37</sup>
</xref>; sum of parent drug and metabolite trough concentration for sunitinib and N&#8208;desethyl&#8208;sunitinib<xref rid="psp412689-bib-0038" ref-type="bibr">
<sup>38</sup>
</xref>; and time to reach a concentration below 0.2&#160;&#956;mol/L for methotrexate.<xref rid="psp412689-bib-0039" ref-type="bibr">
<sup>39</sup>
</xref> A detailed description of these models and the related data are provided in Table&#160;<xref rid="psp412689-tbl-0003" ref-type="table">3</xref>.</p><table-wrap position="float" id="psp412689-tbl-0003" content-type="TABLE" orientation="portrait"><label>TABLE 3</label><caption><p>Real models and data description</p></caption><table frame="hsides" rules="groups"><col style="border-right:solid 1px #000000" span="1"/><col style="border-right:solid 1px #000000" span="1"/><col style="border-right:solid 1px #000000" span="1"/><col style="border-right:solid 1px #000000" span="1"/><col style="border-right:solid 1px #000000" span="1"/><col style="border-right:solid 1px #000000" span="1"/><thead valign="top"><tr style="border-bottom:solid 1px #000000"><th align="left" valign="top" rowspan="1" colspan="1">
<italic toggle="yes">N</italic>&#176;</th><th align="left" valign="top" rowspan="1" colspan="1">Model/drug</th><th align="left" valign="top" rowspan="1" colspan="1">Doses</th><th align="left" valign="top" rowspan="1" colspan="1">Features</th><th align="left" valign="top" rowspan="1" colspan="1">Sampling</th><th align="left" valign="top" rowspan="1" colspan="1">Outcome</th></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1">901</td><td align="left" rowspan="1" colspan="1">Carboplatin<xref rid="psp412689-bib-0032" ref-type="bibr">
<sup>32</sup>
</xref>
</td><td align="left" rowspan="1" colspan="1">
<p>Single 1&#8208;h i.v.</p>
<p>Amt: 500, 750, 1000, 1250&#160;mg</p>
</td><td align="left" rowspan="1" colspan="1">Linear bicompartmental model with proportional error (three parameters)</td><td align="left" rowspan="1" colspan="1">
<p>0.95&#160;&#177;&#160;0.1 h</p>
<p>2&#160;&#177;&#160;0.2 h</p>
<p>5&#160;&#177;&#160;0.3 h</p>
</td><td align="left" rowspan="1" colspan="1">Remaining dose to obtain an AUC of 24&#160;mg&#183;min/ml</td></tr><tr><td align="left" rowspan="1" colspan="1">911</td><td align="left" rowspan="1" colspan="1">Ibrutinib<xref rid="psp412689-bib-0033" ref-type="bibr">
<sup>33</sup>
</xref>, <xref rid="psp412689-bib-0034" ref-type="bibr">
<sup>34</sup>
</xref>
</td><td align="left" rowspan="1" colspan="1">
<p>Multiple oral (one dose, SS&#160;=&#160;1, ii = 24, then one dose at time 24h, SS&#160;=&#160;0).</p>
<p>Amt: 140, 280, 420, 560&#160;mg</p>
</td><td align="left" rowspan="1" colspan="1">Oral absorption with zero&#8208;order and lag time, parent + metabolite (12 parameters)</td><td align="left" rowspan="1" colspan="1">
<p>23.5&#160;&#177;&#160;0.5 h</p>
<p>26&#160;&#177;&#160;0.5 h</p>
<p>28&#160;&#177;&#160;0.5 h</p>
</td><td align="left" rowspan="1" colspan="1">AUC<sub>&#964;,SS</sub>
</td></tr><tr><td align="left" rowspan="1" colspan="1">921</td><td align="left" rowspan="1" colspan="1">Pazopanib<xref rid="psp412689-bib-0036" ref-type="bibr">
<sup>36</sup>
</xref>
</td><td align="left" rowspan="1" colspan="1">
<p>Multiple oral (addl&#160;=&#160;27, ii&#160;=&#160;24).</p>
<p>Amt: 200, 400, 800, 1000&#160;mg and mixed</p>
</td><td align="left" rowspan="1" colspan="1">Dual first&#8208;order absorption with time&#8208;varying and dose&#8208;varying variability (time&#8208;varying covariate). IOV on relative bioavailability. Mixed residual error (six parameters)</td><td align="left" rowspan="1" colspan="1">
<p>330&#160;&#177;&#160;5 h (Cycle 1)</p>
<p>672&#160;&#177;&#160;10 h (Cycle 2)</p>
</td><td align="left" rowspan="1" colspan="1">Cmin</td></tr><tr><td align="left" rowspan="1" colspan="1">931</td><td align="left" rowspan="1" colspan="1">Cabozantinib<xref rid="psp412689-bib-0035" ref-type="bibr">
<sup>35</sup>
</xref>
</td><td align="left" rowspan="1" colspan="1">
<p>Multiple oral (addl&#160;=&#160;27, ii&#160;=&#160;24).</p>
<p>Amt: 20, 40, 60&#160;mg and mixed</p>
</td><td align="left" rowspan="1" colspan="1">Dual first&#8208;order and zero&#8208;order absorption, dose&#8208;dependent absorption rate, exponential residual error (four parameters)</td><td align="left" rowspan="1" colspan="1">672&#160;&#177;&#160;10 h</td><td align="left" rowspan="1" colspan="1">Cmin</td></tr><tr><td align="left" rowspan="1" colspan="1">941</td><td align="left" rowspan="1" colspan="1">Sunitinib<xref rid="psp412689-bib-0038" ref-type="bibr">
<sup>38</sup>
</xref>
</td><td align="left" rowspan="1" colspan="1">
<p>Multiple oral (addl&#160;=&#160;13, ii&#160;=&#160;24).</p>
<p>Amt: 25, 37.5, 50&#160;mg and mixed</p>
</td><td align="left" rowspan="1" colspan="1">Parent + metabolite, nonlinear PK (concentration&#8208;dependent clearance) (four parameters)</td><td align="left" rowspan="1" colspan="1">336&#160;&#177;&#160;10 h</td><td align="left" rowspan="1" colspan="1">Sum Cmin Suni + NDSuni</td></tr><tr><td align="left" rowspan="1" colspan="1">951</td><td align="left" rowspan="1" colspan="1">Methotrexate<xref rid="psp412689-bib-0039" ref-type="bibr">
<sup>39</sup>
</xref>
</td><td align="left" rowspan="1" colspan="1">
<p>Single 6 h&#8208;i.v.</p>
<p>Amt: 2000, 5000, 8000, and 10000&#160;mg</p>
</td><td align="left" rowspan="1" colspan="1">Linear bicompartmental model, IOV on clearance, and proportional error (six parameters)</td><td align="left" rowspan="1" colspan="1">
<p>24&#160;&#177;&#160;3 h</p>
<p>48&#160;&#177;&#160;3 h</p>
<p>At Cycle 1 and Cycle 2</p>
</td><td align="left" rowspan="1" colspan="1">Time to reach a concentration of 0.2&#160;&#956;M</td></tr><tr><td align="left" rowspan="1" colspan="1">962</td><td align="left" rowspan="1" colspan="1">Voriconazole (adult patients and oral dosing)<xref rid="psp412689-bib-0037" ref-type="bibr">
<sup>37</sup>
</xref>
</td><td align="left" rowspan="1" colspan="1">Multiple oral (two 400&#160;mg doses, ii&#160;=&#160;12, then 200&#160;mg, addl&#160;=&#160;11, ii&#160;=&#160;12)</td><td align="left" rowspan="1" colspan="1">Linear and time&#8208;varying Michaelis&#8211;Menten elimination, with very large IIV (variance 1.39). Box&#8208;Cox transformed bioavailability. Exponential residual error (seven parameters)</td><td align="left" rowspan="1" colspan="1">
<p>72&#160;&#177;&#160;5 h</p>
<p>168&#160;&#177;&#160;5 h</p>
</td><td align="left" rowspan="1" colspan="1">Cmin</td></tr></tbody></table><table-wrap-foot id="psp412689-ntgp-0003"><fn id="psp412689-note-0004"><p>Abbreviations: addl, additional given dose; Amt, amount; AUC, area under the curve of concentrations versus time; AUC<sub>&#964;,SS</sub>, AUC at steady state between two doses; Cmin, trough concentration; ii, interdose interval in hours; IIV, inter&#8208;individual variability; IOV, interoccasion variability; i.v., intravenous; NDSuni, N&#8208;desethyl&#8208;sunitinib; PK, pharmacokinetics; SS, steady state; Suni, sunitinib.</p></fn></table-wrap-foot><permissions><copyright-holder>John Wiley &amp; Sons, Ltd</copyright-holder></permissions></table-wrap></sec><sec id="psp412689-sec-0009"><title>Analysis</title><p>Parameters were estimated with mapbayr and NONMEM with software specifications mentioned in the <xref rid="psp412689-sup-0002" ref-type="supplementary-material">Supplementary Materials</xref>. The performance of mapbayr was assessed by computing the maximum absolute difference on <mml:math id="jats-math-41"><mml:msub><mml:mover accent="true"><mml:mi>&#951;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi mathvariant="italic">ik</mml:mi></mml:msub></mml:math> obtained with mapbayr (<mml:math id="jats-math-42"><mml:msub><mml:mover accent="true"><mml:mi>&#951;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mi>B</mml:mi><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:math>) and NONMEM (<mml:math id="jats-math-43"><mml:msub><mml:mover accent="true"><mml:mi>&#951;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:math>) for every individual as follows: <disp-formula id="psp412689-disp-0004"><mml:math id="jats-math-44" display="block"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#916;</mml:mi><mml:mover accent="true"><mml:mi>&#951;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="|" open="|" separators=""><mml:msub><mml:mover accent="true"><mml:mi>&#951;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mi>B</mml:mi><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>&#8208;</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>&#951;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
<disp-formula id="psp412689-disp-0005"><mml:math id="jats-math-45" display="block"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#916;</mml:mi><mml:mover accent="true"><mml:mi>&#951;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal">max</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#916;</mml:mi><mml:mover accent="true"><mml:mi>&#951;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:msub></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
</p><p>These values have no unit. However, provided that individual PK parameters (<mml:math id="jats-math-46"><mml:msub><mml:mi>&#952;</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math>) were log&#8208;normally distributed around a typical value (<mml:math id="jats-math-47"><mml:msub><mml:mi>&#952;</mml:mi><mml:mi mathvariant="italic">TV</mml:mi></mml:msub></mml:math>) such as <mml:math id="jats-math-48"><mml:mrow><mml:msub><mml:mi>&#952;</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mi>&#952;</mml:mi><mml:mi mathvariant="italic">TV</mml:mi></mml:msub><mml:mo>&#8729;</mml:mo><mml:mi mathvariant="normal">exp</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>&#951;</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math>, the maximum error on parameter value could be defined by <mml:math id="jats-math-49"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#916;</mml:mi><mml:mover accent="true"><mml:mi>&#952;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mspace width="0.166667em"/><mml:mfrac><mml:mrow><mml:msub><mml:mi>&#952;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">MBR</mml:mi></mml:mrow></mml:msub><mml:mo>&#8208;</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mi>&#952;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">NM</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>&#952;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">NM</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">exp</mml:mi></mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#916;</mml:mi><mml:mover accent="true"><mml:mi>&#951;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mo>&#8208;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math>. Thus, performance thresholds could be defined accordingly. If <mml:math id="jats-math-50"><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#916;</mml:mi><mml:mover accent="true"><mml:mi>&#951;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:math> was lower than 0.001, estimation was considered excellent because the impact on parameter values would be negligible (<mml:math id="jats-math-51"><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#916;</mml:mi><mml:mover accent="true"><mml:mi>&#952;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:math>&#160;&lt;&#160;0.1%). If <mml:math id="jats-math-52"><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#916;</mml:mi><mml:mover accent="true"><mml:mi>&#951;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:math> was higher than 0.095, the estimation was considered discordant (<mml:math id="jats-math-53"><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#916;</mml:mi><mml:mover accent="true"><mml:mi>&#952;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:math>&#160;&gt;&#160;10%). In other cases, estimation was considered acceptable. The same classification was applied to the absolute error on the PK outcomes measured with the real models.</p><p>Although NONMEM was considered as the reference that should return the best estimate of <mml:math id="jats-math-54"><mml:msub><mml:mi>&#951;</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math>, this assumption was challenged by comparing the <mml:math id="jats-math-55"><mml:msub><mml:mi mathvariant="normal">OFV</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math> returned by both software. However, the actual <mml:math id="jats-math-56"><mml:msub><mml:mi mathvariant="normal">OFV</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math> returned by NONMEM into the .phi file includes a constant term that is missing in the formula in the "MAP Bayesian estimation" Section. Thus, the direct comparison of NONMEM&#8217;s <mml:math id="jats-math-57"><mml:msub><mml:mi mathvariant="normal">OFV</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math> to mapbayr's <mml:math id="jats-math-58"><mml:msub><mml:mi mathvariant="normal">OFV</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math> (<mml:math id="jats-math-59"><mml:msub><mml:mi mathvariant="normal">OFV</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">MBR</mml:mi></mml:mrow></mml:msub></mml:math>) could not be performed. A NONMEM&#8208;like <mml:math id="jats-math-60"><mml:msub><mml:mi mathvariant="normal">OFV</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math> (<mml:math id="jats-math-61"><mml:mrow><mml:msub><mml:mi mathvariant="normal">OFV</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">NM</mml:mi><mml:mo>&#8208;</mml:mo><mml:mi mathvariant="normal">like</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math> was recomputed using <mml:math id="jats-math-62"><mml:msub><mml:mover accent="true"><mml:mi>&#951;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">NM</mml:mi></mml:mrow></mml:msub></mml:math> with the same formula as in Section 2.1 to ensure comparison to <mml:math id="jats-math-63"><mml:msub><mml:mtext>OFV</mml:mtext><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mtext>MBR</mml:mtext></mml:mrow></mml:msub></mml:math>.</p></sec></sec></sec><sec sec-type="results" id="psp412689-sec-0010"><title>RESULTS</title><sec id="psp412689-sec-0011"><title>Package features</title><p>mapbayr strongly relies on features provided by mrgsolve, a package to perform simulations from PK or PK/PD models. Notably, mrgsolve was intentionally designed to be similar to NONMEM in terms of model coding, with code blocks written in R/C++ with a syntax close to that of NONMEM&#8217;s FORTRAN. Thus, if a user is familiar with NONMEM, it is rather straightforward to transpose a model into mrgsolve, unlike other available packages such as RxODE or nlmixr.<xref rid="psp412689-bib-0021" ref-type="bibr">
<sup>21</sup>
</xref>, <xref rid="psp412689-bib-0040" ref-type="bibr">
<sup>40</sup>
</xref> mrgsolve also accepts data passed into a NM&#8208;TRAN format.</p><p>Overall, mapbayr was built around mrgsolve to perform MAP&#8208;BE from a mrgsolve model and includes the following features:
<list list-type="bullet" id="psp412689-list-0005"><list-item><p>MAP&#8208;BE with R only. An additional software such as NONMEM, or MATLAB is not needed.</p></list-item><list-item><p>MAP&#8208;BE with every type of structural model accepted in mrgsolve, including time&#8208;varying covariates and nonlinear PK.</p></list-item><list-item><p>MAP&#8208;BE with any random effects on parameters, including interoccasion variability (IOV) and correlations between IIV terms.</p></list-item><list-item><p>MAP&#8208;BE with proportional, additive, mixed, and exponential residual error models. There is no need to transform the data or to pass additional arguments.</p></list-item><list-item><p>MAP&#8208;BE with dependent variables defined in multiple compartments, such as parent drug and its metabolite.</p></list-item></list>
</p><p>However, procedures available in NONMEM that do not rely on a unique minimization of the likelihood with respect to the etas, such as mixture models, are not natively supported by mapbayr.</p><p>In practice, estimations are performed with a single function that only requires two arguments: model and data.</p><p>
<monospace>my_model &lt;&#8208; mread(&#8220;path/to/my/model/code.cpp&#8221;) # a mrgsolve model</monospace>
</p><p>
<monospace>my_data &lt;&#8208; read.csv(&#8220;path/to/my/dataset.csv&#8221;) #a NM&#8208;TRAN dataset</monospace>
</p><p>
<monospace>my_est &lt;&#8208; mapbayest(my_model, my_data)</monospace>
</p><p>Additional features also include functions to enter information about administrations and observations so that the data set is automatically formatted to NM&#8208;TRAN format as well as methods to plot and summarize the results of estimation. These functions deal with the burden of formatting data and plotting results so that the programmer can focus on functions specific to the drug and TDM protocol. To that extent, model and estimation objects are meant to be exploited by functions coded by the user to derive the PK outcome of interest (AUC, simulated concentrations, dose proposal, etc.) and to be included into a Shiny application (Figure&#160;<xref rid="psp412689-fig-0001" ref-type="fig">1</xref>).</p></sec><sec id="psp412689-sec-0012"><title>Validation of test models</title><p>Over the 140,000 estimations performed with both NONMEM and mapbayr on test models, median <mml:math id="jats-math-64"><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#916;</mml:mi><mml:mover accent="true"><mml:mi>&#952;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:math> was 0.0004%, and 98% of estimations were excellent (<mml:math id="jats-math-65"><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#916;</mml:mi><mml:mover accent="true"><mml:mi>&#952;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:math>&#160;&lt;&#160;0.1%), 0.5% were acceptable, and 1.5% were discordant (<mml:math id="jats-math-66"><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#916;</mml:mi><mml:mover accent="true"><mml:mi>&#952;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:math>&#160;&gt;&#160;10%) (Figure&#160;<xref rid="psp412689-fig-0002" ref-type="fig">2</xref>). Excellent performances were found in particular for the default models (Runs 1 and 2), models with bicompartmental distribution (101 and 102), time&#8208;varying covariates (301 and 302), and alternative residual error models (401 to 408).</p><fig position="float" fig-type="FIGURE" id="psp412689-fig-0002" orientation="portrait"><label>FIGURE 2</label><caption><p>Performance with 35 test models and four dosing/sampling regimens on parameter estimation. Each line represents 1000 estimations with an associated performance score: excellent if <mml:math id="jats-math-67"><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#916;</mml:mi><mml:mover accent="true"><mml:mi>&#952;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:math>&#160;&lt;&#160;0.1%, discordant if <mml:math id="jats-math-68"><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#916;</mml:mi><mml:mover accent="true"><mml:mi>&#952;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:math>&#160;&gt;&#160;10%, and acceptable in between. Dashed line indicates 95th percentile</p></caption><graphic xmlns:xlink="http://www.w3.org/1999/xlink" position="anchor" id="jats-graphic-3" orientation="portrait" xlink:href="PSP4-10-1208-g002.jpg"/></fig><p>However, in some situations, a higher percentage of individuals with discordant estimations was observed. The highest discordances were seen with Runs 3, 4, and 6 with rich sampling; among these 6000 individuals, 371 (6.2%) had discordant estimates. These models needed an estimation of lag time (Run 3) or a zero&#8208;order infusion duration from extravascular compartment (Runs 4 and 6), whereas no discrepancy was observed when bioavailability (Run 8) or first&#8208;order absorption constants (Runs 7 and 8) had to be estimated. Among these 371 patients, <mml:math id="jats-math-69"><mml:msub><mml:mi mathvariant="normal">OFV</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">MBR</mml:mi></mml:mrow></mml:msub></mml:math> was lower than <mml:math id="jats-math-70"><mml:msub><mml:mi mathvariant="normal">OFV</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">NM</mml:mi><mml:mo>&#8208;</mml:mo><mml:mi mathvariant="normal">like</mml:mi></mml:mrow></mml:msub></mml:math> in 225 patients (61%), suggesting that the actual <mml:math id="jats-math-71"><mml:msub><mml:mover accent="true"><mml:mi>&#951;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math> was more likely to be found with mapbayr rather than NONMEM (Figure&#160;<xref rid="psp412689-fig-0003" ref-type="fig">3</xref>). Thus, mapbayr was probably worse than NONMEM in only 146 of the 6000 individuals (2.4%), and differences on parameter estimates were mainly observed on the absorption parameters (lag time [LAG] or infusion duration [DUR]) rather than on apparent CL, with median <mml:math id="jats-math-72"><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#916;</mml:mi><mml:mover accent="true"><mml:mi>&#952;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">LAG</mml:mi><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">or</mml:mi><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">DUR</mml:mi></mml:mrow></mml:msub></mml:math>&#160;=&#160;24% and <mml:math id="jats-math-73"><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#916;</mml:mi><mml:mover accent="true"><mml:mi>&#952;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">CL</mml:mi></mml:mrow></mml:msub></mml:math>&#160;=&#160;1.6%, respectively.</p><fig position="float" fig-type="FIGURE" id="psp412689-fig-0003" orientation="portrait"><label>FIGURE 3</label><caption><p>OFVs at maximum likelihood for mapbayr and NONMEM. They were aligned on the identity line for the majority of individuals (4000 per run). Discrepancies were in favor of mapbayr for Run 3 (lag time), mainly in favor of NONMEM for Runs 207 (Michaelis&#8211;Menten elimination) and 504&#8211;513 (large inter&#8208;individual variability), and balanced for Runs 4, 6 (infusion duration), and 911 (ibrutinib). One out&#8208;of&#8208;bound value is omitted in Run 911. OFV, objective function value</p></caption><graphic xmlns:xlink="http://www.w3.org/1999/xlink" position="anchor" id="jats-graphic-5" orientation="portrait" xlink:href="PSP4-10-1208-g003.jpg"/></fig><p>For models with a nonlinear Michaelis&#8211;Menten elimination (Runs 201 to 208), 2.5% of estimations were discordant in the &#8220;multiple doses + sparse sampling&#8221; setup. This rate was up to 6.1% with Model 207, when KA, VC, CL, V<sub>MAX</sub>, and K<sub>M</sub> had to be estimated from a single point at steady state. Unlike Runs 3, 4, and 6, <mml:math id="jats-math-74"><mml:msub><mml:mi mathvariant="normal">OFV</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">MBR</mml:mi></mml:mrow></mml:msub></mml:math> was always the same or higher than <mml:math id="jats-math-75"><mml:msub><mml:mi mathvariant="normal">OFV</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">NM</mml:mi><mml:mo>&#8208;</mml:mo><mml:mi mathvariant="normal">like</mml:mi></mml:mrow></mml:msub></mml:math> (Figure&#160;<xref rid="psp412689-fig-0003" ref-type="fig">3</xref>), suggesting that discordant estimates returned by mapbayr were probably less correct compared with NONMEM&#8217;s.</p><p>For Runs 501 to 513, the percentage of individuals with discordant estimations increased proportionally to the IIV value set in the model. Focusing on the &#8220;multiple doses + rich sampling&#8221; setting (Figure&#160;<xref rid="psp412689-fig-0002" ref-type="fig">2</xref>), a maximum of 15% discordances was observed with Model 513 (<mml:math id="jats-math-76"><mml:msubsup><mml:mi>&#969;</mml:mi><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math>&#160;=&#160;2 on every parameter). The percentage of discordant estimations was not higher than 7% if <mml:math id="jats-math-77"><mml:msubsup><mml:mi>&#969;</mml:mi><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math> was equal to 2 on certain parameters only (Runs 511 and 512) or if <mml:math id="jats-math-78"><mml:msubsup><mml:mi>&#969;</mml:mi><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math> was less or equal to 1 on all parameters (from 501 to 504). <mml:math id="jats-math-79"><mml:msub><mml:mi mathvariant="normal">OFV</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">MBR</mml:mi></mml:mrow></mml:msub></mml:math> was often higher than or equal to <mml:math id="jats-math-80"><mml:msub><mml:mi mathvariant="normal">OFV</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">NM</mml:mi><mml:mo>&#8208;</mml:mo><mml:mi mathvariant="normal">like</mml:mi></mml:mrow></mml:msub></mml:math> (Figure&#160;<xref rid="psp412689-fig-0003" ref-type="fig">3</xref>). Because simulations were performed by sampling from large parameter distributions, we hypothesized that a substantial number of PK profiles were probably abnormal and reperformed the analysis after the exclusion of PK profiles with concentrations censored to 0.1&#160;&#181;g/ml. All sampling/dosing cohorts combined, a maximum of 4.9% discordance was observed (Run 513). Focusing on a specific cohort, only 3/28 returned a discordance rate higher than 5%, all with at least two <mml:math id="jats-math-81"><mml:msubsup><mml:mi>&#969;</mml:mi><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math>&#160;=&#160;2 (Table&#160;<xref rid="psp412689-sup-0001" ref-type="supplementary-material">S1</xref>).</p></sec><sec id="psp412689-sec-0013"><title>Validation of the real models</title><p>For the seven real models, the performance of mapbayr was satisfactory with overall 97.3% and 99.3% of excellent estimations for PK parameters and PK outcomes, respectively (Figure&#160;<xref rid="psp412689-fig-0004" ref-type="fig">4</xref>). The run with ibrutinib (911), a complex model with 12 parameters to estimate, returned a median <mml:math id="jats-math-82"><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#916;</mml:mi><mml:mover accent="true"><mml:mi>&#952;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:math> of 0.05%, compared with 0.0004% for the test models. Despite this genuine loss in performance (about 150 times less precise), estimations were satisfactory in terms of parameters (84.3% excellent and only 0.7% discordant) and in terms of PK outcome with only 5/1000 individuals with an error &gt;10% on AUC<sub>&#964;,SS</sub>. For methotrexate (Run 951), the predicted time to reach a concentration below 0.2&#160;&#956;M was discordant in only 6/1000 patients, corresponding to outlier situations when concentration was already lower than 0.2&#160;&#956;M at the first sample, or concentrations higher at 48&#160;h than 24&#160;h postdose. For voriconazole, trough concentration predictions were discordant for 6/1000 patients only, despite the structural complexity of the model and the very large variance set on Michaelis&#8211;Menten elimination parameters (shared eta with <mml:math id="jats-math-83"><mml:msubsup><mml:mi>&#969;</mml:mi><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math>&#160;=&#160;1.39). For the other real models, 100% rates of &#8220;excellent&#8221; estimation (difference &lt;0.1%) between mapbayr and NONMEM were achieved. The proposed dose to reach an AUC of 24&#160;mg&#183;min/ml for carboplatin (Run 901) ranged from 0 to 6000&#160;mg. The steady&#8208;state trough concentrations of pazopanib, cabozantinib, and sunitinib&#160;+&#160;NDsunitinib were estimated identically by both software (median values 19&#160;mg/L, 0.66&#160;mg/L, and 45&#160;mg/L, respectively), which would lead to an identical dose adaptation if used in the context of TDM.</p><fig position="float" fig-type="FIGURE" id="psp412689-fig-0004" orientation="portrait"><label>FIGURE 4</label><caption><p>Performance with seven real models on parameter (left) and specific PK outcome (right) estimation. Dashed line indicates 95th percentile. AUC, area under the curve of concentrations versus time; AUC<sub>&#964;,SS</sub>, AUC at steady state between two doses; C24ss, trough concentration at steady state</p></caption><graphic xmlns:xlink="http://www.w3.org/1999/xlink" position="anchor" id="jats-graphic-7" orientation="portrait" xlink:href="PSP4-10-1208-g004.jpg"/></fig></sec></sec><sec sec-type="discussion" id="psp412689-sec-0014"><title>DISCUSSION</title><p>A package that enables the MAP&#8208;BE of PK parameters in R was developed, and its prediction capacity was validated against the gold&#8208;standard software NONMEM.</p><p>The performance of mapbayr is overall equivalent to NONMEM&#8217;s for a wide variety of test models. Most of the discrepancies were observed when large IIVs were investigated (Runs 501 to 513), notably when <mml:math id="jats-math-84"><mml:msubsup><mml:mi>&#969;</mml:mi><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math>&#160;=&#160;2 on all parameters (Run 513). This is probably because large variances cause a flatter surface of the likelihood, which makes minimization difficult. However, in real&#8208;life situations, such high discordance rates are unlikely because the current test scenarios probably returned abnormal PK profiles due to sampling from very large distributions for a majority of parameters. Indeed, the reanalysis of test model data without censored concentrations (0.1&#160;&#181;g/ml) returned more acceptable results (Table&#160;<xref rid="psp412689-sup-0001" ref-type="supplementary-material">S1</xref>). In real life, very large variances (&gt;1) on several parameters and such aberrant profiles seem highly unlikely. For the voriconazole model, excellent rates of concentration estimation were observed despite a variance higher than one on elimination parameters (Figure&#160;<xref rid="psp412689-fig-0003" ref-type="fig">3</xref>). Overall, for a few individuals, mapbayr is genuinely outperformed by NONMEM when MAP&#8208;BE is performed with large IIV variances (<mml:math id="jats-math-85"><mml:msubsup><mml:mi>&#969;</mml:mi><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math>&#160;&gt;&#160;1) on several estimable parameters. In those rare cases, mapbayr use remains possible, although it would be advisable to perform a validation versus NONMEM from simulated data with the expected dosing/sampling strategy (i.e., &#8220;real&#8208;models&#8221; setting).</p><p>Several discrepancies were also seen when lag time or infusion duration were estimated, but the exploration of <mml:math id="jats-math-86"><mml:mrow><mml:msub><mml:mi mathvariant="normal">OFV</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mspace width="0.166667em"/></mml:mrow></mml:math>suggested that estimates from mapbayr were often more likely than those of NONMEM. This might be because lag times can create big discontinuities in <mml:math id="jats-math-87"><mml:msub><mml:mi mathvariant="normal">OFV</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math>, due to the prediction of null concentrations if a lag time is greater than an observation time. For instance, if a concentration is observed at time <italic toggle="yes">t</italic>&#160;=&#160;0.5 h, and a lag time of 1 h (typical value) is tested by the optimization algorithm, an extremely high <mml:math id="jats-math-88"><mml:msub><mml:mi mathvariant="normal">OFV</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math> would be returned whatever the values of the other parameters (CL, V) because the dose is still missing in the system. This situation leads to local minimums, which is why <mml:math id="jats-math-89"><mml:mrow><mml:msub><mml:mi mathvariant="normal">OFV</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mspace width="0.166667em"/></mml:mrow></mml:math> around 10<sup>4</sup> to 10<sup>7</sup> were observed for some patients in Run 3, whereas the global minimum was expected around 10<sup>1</sup> or 10<sup>2</sup> (Figure&#160;<xref rid="psp412689-fig-0003" ref-type="fig">3</xref>). Thus, for some patients, when lag time and infusion duration had to be estimated, mapbayr could outdo NONMEM provided that our own computation of <mml:math id="jats-math-90"><mml:mspace width="0.166667em"/><mml:msub><mml:mi mathvariant="normal">OFV</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mi>NM</mml:mi><mml:mo>&#8208;</mml:mo><mml:mi>like</mml:mi><mml:mspace width="0.166667em"/></mml:mrow></mml:msub></mml:math> is not false.</p><p>However, in other situations (Michaelis&#8211;Menten elimination, large IIV), differences between mapbayr and NONMEM were often in favor of the latter. The different algorithms used (L&#8208;BFGS&#8208;B vs. BFGS) and their associated settings probably explain these discrepancies in estimation. The hypothesis of differences in concentration prediction that would distort the computation of <mml:math id="jats-math-91"><mml:msub><mml:mi mathvariant="normal">OFV</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math> is less likely. Both software use the LSODA ODE solver to predict concentrations, and its C++ implementation in mrgsolve was found to be consistent to NONMEM&#8217;s given the performances provided by mrgsolve.<xref rid="psp412689-bib-0041" ref-type="bibr">
<sup>41</sup>
</xref>
</p><p>Estimation of parameters for real models (901 and more) returned a high percentage of patients with excellent performance despite a higher complexity in both structural and error models. This proves the estimation returned by mapbayr (<mml:math id="jats-math-92"><mml:msub><mml:mover accent="true"><mml:mi>&#951;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">MBR</mml:mi></mml:mrow></mml:msub></mml:math>) is as reliable than the NONMEM estimate (<mml:math id="jats-math-93"><mml:msub><mml:mover accent="true"><mml:mi>&#951;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">NM</mml:mi></mml:mrow></mml:msub></mml:math>). However, it cannot inform us regarding the ability to return the actual value of <mml:math id="jats-math-94"><mml:msub><mml:mi>&#951;</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math>. Indeed, although any PK model reported in the literature could theoretically be coded within mapbayr to perform MAP&#8208;BE and derive an individualized dose, the Bayesian estimation design must have been previously validated.<xref rid="psp412689-bib-0042" ref-type="bibr">
<sup>42</sup>
</xref> First, the residual error defined in the PK model must be small enough to correctly estimate PK parameters and avoid <mml:math id="jats-math-95"><mml:mi>&#951;</mml:mi></mml:math>&#8208;shrinkage on key parameters (to be defined depending on the clinical applications).<xref rid="psp412689-bib-0043" ref-type="bibr">
<sup>43</sup>
</xref> Second, the sampling strategy must have been previously validated to make sure that parameter estimation is precise enough, especially when very sparse sampling is used in the context of a routine TDM. These questions of design optimality can be addressed with specific software (notably the R packages PFIM<xref rid="psp412689-bib-0044" ref-type="bibr">
<sup>44</sup>
</xref> or PopED<xref rid="psp412689-bib-0045" ref-type="bibr">
<sup>45</sup>
</xref>) or more pragmatic approaches such as validation on a clinical data set.</p><p>There was no proper comparison of run times of mapbayr versus NONMEM; however, there is no doubt that the first is slower because it was mainly written in R language, which is known to be slower than FORTRAN. Computation time increased with the number of parameters estimated: from milliseconds per individual for simple models with three to four parameters, to a couple of seconds for complex models with 12 parameters such as ibrutinib. Hence, maybayr's run times are fully compatible with routine use in clinical practice.</p><p>Although some difficulties in the generalization of MIPD remain to be overcome (e.g., regulatory aspects that may require registration of these tools as medical devices in some countries),<xref rid="psp412689-bib-0046" ref-type="bibr">
<sup>46</sup>
</xref> this tool will undoubtedly be of great interest for clinically oriented researchers.</p><p>From the estimated PK parameters, the user can derive PK outcomes of interest with standard R programming. Using simple arithmetic functions, an AUC can be derived from (oral) CL and dose. Moreover, using the mrgsolve framework, individual concentrations can be predicted at any times assumed relevant by the user. For example, the concentration of a tyrosine kinase inhibitor could be predicted exactly 24 h after the last intake to compare it to an efficacy threshold if sampling time has not been respected.<xref rid="psp412689-bib-0047" ref-type="bibr">
<sup>47</sup>
</xref> The time at which a drug concentration reaches a given threshold can also be predicted to infer the time to next administration or to decide on a patient's discharge (e.g., for methotrexate). Alternative dosing schedules can also be simulated from <italic toggle="yes">a posteriori</italic> individual PK parameters to predict dose adjustment and manage drug exposure. Several examples of shiny applications that include these procedures are provided in a dedicated repository at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/FelicienLL/mapbayr-shiny" ext-link-type="uri">https://github.com/FelicienLL/mapbayr&#8208;shiny</ext-link>.</p><p>Currently, estimations performed by mapbayr are only maximum <italic toggle="yes">a posteriori</italic>, which means most probable parameter values without taking uncertainties of estimation into account. Recently, Bayesian data assimilation methods have been suggested to overcome this limitation in the context of TDM.<xref rid="psp412689-bib-0048" ref-type="bibr">
<sup>48</sup>
</xref> Future versions of mapbayr could implement procedures based on the Fisher information matrix or on sampling from the posterior distribution. As a free and open&#8208;source package, mapbayr is developed on Github and available on Comprehensive R Archive Network. Users are welcome to suggest features, report bugs, and participate in development at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/FelicienLL/mapbayr" ext-link-type="uri">https://github.com/FelicienLL/mapbayr</ext-link>.</p><p>In conclusion, instead of providing a ready&#8208;made application that would only be applicable for a limited number of users and clinical situations and mimic existing MIPD software, we developed a general tool to deal with the most sensitive step of model&#8208;based TDM: the MAP&#8208;BE. With mapbayr, anyone familiar with R can transpose any of his/her own models into a Shiny web application to perform TDM with a reliable MAP&#8208;BE of individual parameters without external modeling software. We hope this approach will help the development of MIPD, especially in less&#8208;considered therapeutic areas such as oncology.</p></sec><sec sec-type="COI-statement" id="psp412689-sec-0016"><title>CONFLICT OF INTEREST</title><p>The authors declared no competing interests for this work.</p></sec><sec id="psp412689-sec-0017"><title>AUTHOR CONTRIBUTIONS</title><p>F.L.L., F.P., F.T., E.C., and M.W.K. wrote the manuscript. F.L.L., E.C., and M.W.K. designed the research. F.L.L. performed the research. F.L.L. and M.W.K. analyzed the data. F.L.L. contributed new analytical tools.</p></sec><sec sec-type="supplementary-material"><title>Supporting information</title><supplementary-material id="psp412689-sup-0001" position="float" content-type="local-data" orientation="portrait"><caption><p>Table S1</p></caption><media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="PSP4-10-1208-s001.docx" position="float" orientation="portrait"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material><supplementary-material id="psp412689-sup-0002" position="float" content-type="local-data" orientation="portrait"><caption><p>Supplementary Material</p></caption><media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="PSP4-10-1208-s002.docx" position="float" orientation="portrait"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material></sec></body><back><ack id="psp412689-sec-0015"><title>ACKNOWLEDGMENT</title><p>The authors warmly thank Kyle T. Baron (Metrum Research Group) for the development of the mrgsolve package and his agreement to work from his tutorial on maximum <italic toggle="yes">a posteriori</italic> Bayes estimation.</p></ack><ref-list content-type="cited-references" id="psp412689-bibl-0001"><title>REFERENCES</title><ref id="psp412689-bib-0001"><label>1</label><mixed-citation publication-type="miscellaneous" id="psp412689-cit-0001"><article-title>Definitions of TDM &amp;CT</article-title>. <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.iatdmct.org/about-us/about-association/about-definitions-tdm-ct.html" ext-link-type="uri">https://www.iatdmct.org/about&#8208;us/about&#8208;association/about&#8208;definitions&#8208;tdm&#8208;ct.html</ext-link>. Accessed June 21, 2021.</mixed-citation></ref><ref id="psp412689-bib-0002"><label>2</label><mixed-citation publication-type="journal" id="psp412689-cit-0002"><string-name name-style="western"><surname>Kang</surname><given-names>J&#8208;S</given-names></string-name>, <string-name name-style="western"><surname>Lee</surname><given-names>M&#8208;H</given-names></string-name>. <article-title>Overview of therapeutic drug monitoring</article-title>. <source>Korean J Intern Med</source>. <year>2009</year>;<volume>24</volume>:<fpage>1</fpage>&#8208;<lpage>10</lpage>.<pub-id pub-id-type="pmid">19270474</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.3904/kjim.2009.24.1.1</pub-id><pub-id pub-id-type="pmcid">PMC2687654</pub-id></mixed-citation></ref><ref id="psp412689-bib-0003"><label>3</label><mixed-citation publication-type="journal" id="psp412689-cit-0003"><string-name name-style="western"><surname>Ting</surname><given-names>LSL</given-names></string-name>, <string-name name-style="western"><surname>Villeneuve</surname><given-names>E</given-names></string-name>, <string-name name-style="western"><surname>Ensom</surname><given-names>MHH</given-names></string-name>. <article-title>Beyond cyclosporine: A systematic review of limited sampling strategies for other immunosuppressants</article-title>. <source>Ther Drug Monit</source>. <year>2006</year>;<volume>28</volume>:<fpage>419</fpage>&#8208;<lpage>430</lpage>.<pub-id pub-id-type="pmid">16778729</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1097/01.ftd.0000211810.19935.44</pub-id></mixed-citation></ref><ref id="psp412689-bib-0004"><label>4</label><mixed-citation publication-type="journal" id="psp412689-cit-0004"><string-name name-style="western"><surname>Chatelut</surname><given-names>E</given-names></string-name>, <string-name name-style="western"><surname>Pivot</surname><given-names>X</given-names></string-name>, <string-name name-style="western"><surname>Otto</surname><given-names>J</given-names></string-name>, et al. <article-title>A limited sampling strategy for determining carboplatin AUC and monitoring drug dosage</article-title>. <source>Eur J Cancer</source>. <year>2000</year>;<volume>36</volume>:<fpage>264</fpage>&#8208;<lpage>269</lpage>.<pub-id pub-id-type="pmid">10741287</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1016/s0959-8049(99)00266-x</pub-id></mixed-citation></ref><ref id="psp412689-bib-0005"><label>5</label><mixed-citation publication-type="journal" id="psp412689-cit-0005"><string-name name-style="western"><surname>Tranchand</surname><given-names>B</given-names></string-name>, <string-name name-style="western"><surname>Amsellem</surname><given-names>C</given-names></string-name>, <string-name name-style="western"><surname>Chatelut</surname><given-names>E</given-names></string-name>, et al. <article-title>A limited&#8208;sampling strategy for estimation of etoposide pharmacokinetics in cancer patients</article-title>. <source>Cancer Chemotherapy Pharmacology</source>. <year>1999</year>;<volume>43</volume>:<fpage>316</fpage>&#8208;<lpage>322</lpage>.<pub-id pub-id-type="pmid">10071983</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1007/s002800050901</pub-id></mixed-citation></ref><ref id="psp412689-bib-0006"><label>6</label><mixed-citation publication-type="journal" id="psp412689-cit-0006"><string-name name-style="western"><surname>van Kuilenburg</surname><given-names>ABP</given-names></string-name>, <string-name name-style="western"><surname>H&#228;usler</surname><given-names>P</given-names></string-name>, <string-name name-style="western"><surname>Schalhorn</surname><given-names>A</given-names></string-name>, et al. <article-title>Evaluation of 5&#8208;fluorouracil pharmacokinetics in cancer patients with a C. 1905+1G&gt;A mutation in DPYD by means of a Bayesian limited sampling strategy</article-title>. <source>Clin Pharmacokinet</source>. <year>2012</year>;<volume>51</volume>:<fpage>163</fpage>&#8208;<lpage>174</lpage>.<pub-id pub-id-type="pmid">22339448</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1007/BF03257473</pub-id></mixed-citation></ref><ref id="psp412689-bib-0007"><label>7</label><mixed-citation publication-type="journal" id="psp412689-cit-0007"><string-name name-style="western"><surname>Wicha</surname><given-names>SG</given-names></string-name>, <string-name name-style="western"><surname>M&#228;rtson</surname><given-names>A&#8208;G</given-names></string-name>, <string-name name-style="western"><surname>Nielsen</surname><given-names>EI</given-names></string-name>, et al. <article-title>From therapeutic drug monitoring to model&#8208;informed precision dosing for antibiotics</article-title>. <source>Clin Pharm Therap</source>. <year>2021</year>;<volume>109</volume>:<fpage>928</fpage>&#8208;<lpage>941</lpage>.<pub-id pub-id-type="doi" assigning-authority="pmc">10.1002/cpt.2202</pub-id><pub-id pub-id-type="pmid">33565627</pub-id></mixed-citation></ref><ref id="psp412689-bib-0008"><label>8</label><mixed-citation publication-type="journal" id="psp412689-cit-0008"><string-name name-style="western"><surname>Sheiner</surname><given-names>LB</given-names></string-name>, <string-name name-style="western"><surname>Rosenberg</surname><given-names>B</given-names></string-name>, <string-name name-style="western"><surname>Melmon</surname><given-names>KL</given-names></string-name>. <article-title>Modelling of individual pharmacokinetics for computer&#8208;aided drug dosage</article-title>. <source>Comput Biomed Res</source>. <year>1972</year>;<volume>5</volume>:<fpage>411</fpage>&#8208;<lpage>459</lpage>.<pub-id pub-id-type="doi" assigning-authority="pmc">10.1016/0010-4809(72)90051-1</pub-id><pub-id pub-id-type="pmid">4634367</pub-id></mixed-citation></ref><ref id="psp412689-bib-0009"><label>9</label><mixed-citation publication-type="book" id="psp412689-cit-0009"><string-name name-style="western"><surname>Beal</surname><given-names>SL</given-names></string-name>, <string-name name-style="western"><surname>Sheiner</surname><given-names>LB</given-names></string-name>, <string-name name-style="western"><surname>Boeckmann</surname><given-names>A</given-names></string-name>, et al. <source><italic toggle="yes">NONMEM Users Guides</italic></source>. <publisher-loc>San Francisco</publisher-loc>: <publisher-name>NONMEM Project Group, University of California</publisher-name>; <year>1992</year>.</mixed-citation></ref><ref id="psp412689-bib-0010"><label>10</label><mixed-citation publication-type="miscellaneous" id="psp412689-cit-0010"><article-title>BestDose Software</article-title>. <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://www.lapk.org/bestdose.php" ext-link-type="uri">http://www.lapk.org/bestdose.php</ext-link>. Accessed June 21, 2021.</mixed-citation></ref><ref id="psp412689-bib-0011"><label>11</label><mixed-citation publication-type="miscellaneous" id="psp412689-cit-0011"><article-title>InsightRX&#8211;Precision Dosing Done Right</article-title>. <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.insight-rx.com/" ext-link-type="uri">https://www.insight&#8208;rx.com/</ext-link>. Accessed June 21, 2021.</mixed-citation></ref><ref id="psp412689-bib-0012"><label>12</label><mixed-citation publication-type="miscellaneous" id="psp412689-cit-0012"><string-name name-style="western"><surname>Precise</surname><given-names>PK</given-names></string-name>. <article-title>A leading therapeutic drug monitoring software for model&#8208;based Bayesian precision dosing</article-title>. <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://precisepk.com/" ext-link-type="uri">https://precisepk.com/</ext-link>. Accessed June 21, 2021.</mixed-citation></ref><ref id="psp412689-bib-0013"><label>13</label><mixed-citation publication-type="journal" id="psp412689-cit-0013"><string-name name-style="western"><surname>Kantasiripitak</surname><given-names>W</given-names></string-name>, <string-name name-style="western"><surname>Van Daele</surname><given-names>R</given-names></string-name>, <string-name name-style="western"><surname>Gijsen</surname><given-names>M</given-names></string-name>, et al. <article-title>Software tools for model&#8208;informed precision dosing: how well do they satisfy the needs?</article-title><source>Front Pharmacol</source>. <year>2020</year>;<volume>11</volume>:<fpage>620</fpage>.<pub-id pub-id-type="pmid">32457619</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.3389/fphar.2020.00620</pub-id><pub-id pub-id-type="pmcid">PMC7224248</pub-id></mixed-citation></ref><ref id="psp412689-bib-0014"><label>14</label><mixed-citation publication-type="journal" id="psp412689-cit-0014"><string-name name-style="western"><surname>Dijkman</surname><given-names>SC</given-names></string-name>, <string-name name-style="western"><surname>Wicha</surname><given-names>SG</given-names></string-name>, <string-name name-style="western"><surname>Danhof</surname><given-names>M</given-names></string-name>, et al. <article-title>Individualized dosing algorithms and therapeutic monitoring for antiepileptic drugs</article-title>. <source>Clin Pharmacol Ther</source>. <year>2018</year>;<volume>103</volume>:<fpage>663</fpage>&#8208;<lpage>673</lpage>.<pub-id pub-id-type="pmid">28653352</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1002/cpt.777</pub-id></mixed-citation></ref><ref id="psp412689-bib-0015"><label>15</label><mixed-citation publication-type="journal" id="psp412689-cit-0015"><string-name name-style="western"><surname>Rousseau</surname><given-names>A</given-names></string-name>, <string-name name-style="western"><surname>Marquet</surname><given-names>P</given-names></string-name>, <string-name name-style="western"><surname>Debord</surname><given-names>J</given-names></string-name>, et al. <article-title>Adaptive control methods for the dose individualisation of anticancer agents</article-title>. <source>Clin Pharmacokinet</source>. <year>2000</year>;<volume>38</volume>:<fpage>315</fpage>&#8208;<lpage>353</lpage>.<pub-id pub-id-type="pmid">10803455</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.2165/00003088-200038040-00003</pub-id></mixed-citation></ref><ref id="psp412689-bib-0016"><label>16</label><mixed-citation publication-type="miscellaneous" id="psp412689-cit-0016"><collab collab-type="authors">R Core Team</collab>
. <article-title>R: A language and environment for statistical computing</article-title>. <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.R-project.org/" ext-link-type="uri">https://www.R&#8208;project.org/</ext-link>. Accessed June 21, 2021.</mixed-citation></ref><ref id="psp412689-bib-0017"><label>17</label><mixed-citation publication-type="miscellaneous" id="psp412689-cit-0017"><article-title>Shiny</article-title>. <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://shiny.rstudio.com/" ext-link-type="uri">https://shiny.rstudio.com/</ext-link>. Accessed June 21, 2021.</mixed-citation></ref><ref id="psp412689-bib-0018"><label>18</label><mixed-citation publication-type="journal" id="psp412689-cit-0018"><string-name name-style="western"><surname>Wojciechowski</surname><given-names>J</given-names></string-name>, <string-name name-style="western"><surname>Hopkins</surname><given-names>AM</given-names></string-name>, <string-name name-style="western"><surname>Upton</surname><given-names>RN</given-names></string-name>. <article-title>Interactive pharmacometric applications using R and the shiny package</article-title>. <source>CPT Pharmacometrics Syst Pharmacol</source>. <year>2015</year>;<volume>4</volume>:<elocation-id>e00021</elocation-id>.<pub-id pub-id-type="pmid">26225240</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1002/psp4.21</pub-id><pub-id pub-id-type="pmcid">PMC4394611</pub-id></mixed-citation></ref><ref id="psp412689-bib-0019"><label>19</label><mixed-citation publication-type="journal" id="psp412689-cit-0019"><string-name name-style="western"><surname>Okour</surname><given-names>M</given-names></string-name>. <article-title>DosePredict: A shiny application for generalized pharmacokinetics&#8208;based dose predictions</article-title>. <source>J Clin Pharmacol</source>. <year>2020</year>;<volume>60</volume>:<fpage>1502</fpage>&#8208;<lpage>1508</lpage>.<pub-id pub-id-type="pmid">32542731</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1002/jcph.1649</pub-id></mixed-citation></ref><ref id="psp412689-bib-0020"><label>20</label><mixed-citation publication-type="journal" id="psp412689-cit-0020"><string-name name-style="western"><surname>Wicha</surname><given-names>SG</given-names></string-name>, <string-name name-style="western"><surname>Kees</surname><given-names>MG</given-names></string-name>, <string-name name-style="western"><surname>Solms</surname><given-names>A</given-names></string-name>, et al. <article-title>TDMx: A novel web&#8208;based open&#8208;access support tool for optimising antimicrobial dosing regimens in clinical routine</article-title>. <source>Int J Antimicrob Agents</source>. <year>2015</year>;<volume>45</volume>:<fpage>442</fpage>&#8208;<lpage>444</lpage>.<pub-id pub-id-type="pmid">25631677</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1016/j.ijantimicag.2014.12.010</pub-id></mixed-citation></ref><ref id="psp412689-bib-0021"><label>21</label><mixed-citation publication-type="journal" id="psp412689-cit-0021"><string-name name-style="western"><surname>Fidler</surname><given-names>M</given-names></string-name>, <string-name name-style="western"><surname>Wilkins</surname><given-names>JJ</given-names></string-name>, <string-name name-style="western"><surname>Hooijmaijers</surname><given-names>R</given-names></string-name>, et al. <article-title>Nonlinear mixed&#8208;effects model development and simulation using nlmixr and related R Open&#8208;Source Packages</article-title>. <source>CPT: Pharmacom Sys. Pharmacol</source>. <year>2019</year>;<volume>8</volume>:<fpage>621</fpage>&#8208;<lpage>633</lpage>.<pub-id pub-id-type="doi" assigning-authority="pmc">10.1002/psp4.12445</pub-id><pub-id pub-id-type="pmcid">PMC6765694</pub-id><pub-id pub-id-type="pmid">31207186</pub-id></mixed-citation></ref><ref id="psp412689-bib-0022"><label>22</label><mixed-citation publication-type="journal" id="psp412689-cit-0022"><string-name name-style="western"><surname>Comets</surname><given-names>E</given-names></string-name>, <string-name name-style="western"><surname>Lavenu</surname><given-names>A</given-names></string-name>, <string-name name-style="western"><surname>Lavielle</surname><given-names>M</given-names></string-name>. <article-title>Parameter estimation in nonlinear mixed effect models using saemix, an R implementation of the SAEM algorithm</article-title>. <source>J Stat Softw</source>. <year>2017</year>;<volume>80</volume>:<fpage>1</fpage>&#8208;<lpage>41</lpage>.</mixed-citation></ref><ref id="psp412689-bib-0023"><label>23</label><mixed-citation publication-type="journal" id="psp412689-cit-0023"><string-name name-style="western"><surname>Wang</surname><given-names>W</given-names></string-name>, <string-name name-style="western"><surname>Hallow</surname><given-names>KM</given-names></string-name>, <string-name name-style="western"><surname>James</surname><given-names>DA</given-names></string-name>. <article-title>A tutorial on RxODE: simulating differential equation pharmacometric models in R</article-title>. <source>CPT Pharmacometrics Syst Pharmacol</source>. <year>2016</year>;<volume>5</volume>:<fpage>3</fpage>&#8208;<lpage>10</lpage>.<pub-id pub-id-type="pmid">26844010</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1002/psp4.12052</pub-id><pub-id pub-id-type="pmcid">PMC4728294</pub-id></mixed-citation></ref><ref id="psp412689-bib-0024"><label>24</label><mixed-citation publication-type="journal" id="psp412689-cit-0024"><string-name name-style="western"><surname>Elmokadem</surname><given-names>A</given-names></string-name>, <string-name name-style="western"><surname>Riggs</surname><given-names>MM</given-names></string-name>, <string-name name-style="western"><surname>Baron</surname><given-names>KT</given-names></string-name>. <article-title>Quantitative systems pharmacology and physiologically&#8208;based pharmacokinetic modeling with mrgsolve: a hands&#8208;on tutorial</article-title>. <source>CPT Pharmacometrics Syst Pharmacol</source>. <year>2019</year>;<volume>8</volume>:<fpage>883</fpage>&#8208;<lpage>893</lpage>.<pub-id pub-id-type="pmid">31652028</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1002/psp4.12467</pub-id><pub-id pub-id-type="pmcid">PMC6930861</pub-id></mixed-citation></ref><ref id="psp412689-bib-0025"><label>25</label><mixed-citation publication-type="miscellaneous" id="psp412689-cit-0025"><string-name name-style="western"><surname>Baron</surname><given-names>KT</given-names></string-name>, <string-name name-style="western"><surname>Gillespie</surname><given-names>B</given-names></string-name>, <string-name name-style="western"><surname>Margossian</surname><given-names>C</given-names></string-name>, et al. <article-title>mrgsolve: simulate from ODE&#8208;based models</article-title>. <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://CRAN.R-project.org/package=mrgsolve" ext-link-type="uri">https://CRAN.R&#8208;project.org/package=mrgsolve</ext-link>. Published <year>2020</year>. Accessed June 21, 2021.</mixed-citation></ref><ref id="psp412689-bib-0026"><label>26</label><mixed-citation publication-type="journal" id="psp412689-cit-0026"><string-name name-style="western"><surname>Kang</surname><given-names>D</given-names></string-name>, <string-name name-style="western"><surname>Bae</surname><given-names>K&#8208;S</given-names></string-name>, <string-name name-style="western"><surname>Houk</surname><given-names>BE</given-names></string-name>, et al. <article-title>Standard error of empirical bayes estimate in NONMEM<sup>&#174;</sup> VI</article-title>. <source>Korean J Physiol Pharmacol</source>. <year>2012</year>;<volume>16</volume>:<fpage>97</fpage>.<pub-id pub-id-type="pmid">22563254</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.4196/kjpp.2012.16.2.97</pub-id><pub-id pub-id-type="pmcid">PMC3339294</pub-id></mixed-citation></ref><ref id="psp412689-bib-0027"><label>27</label><mixed-citation publication-type="journal" id="psp412689-cit-0027"><string-name name-style="western"><surname>Kim</surname><given-names>M&#8208;G</given-names></string-name>, <string-name name-style="western"><surname>Yim</surname><given-names>D&#8208;S</given-names></string-name>, <string-name name-style="western"><surname>Bae</surname><given-names>K&#8208;S</given-names></string-name>. <article-title>R&#8208;based reproduction of the estimation process hidden behind NONMEM<sup>&#174;</sup> Part 1: first&#8208;order approximation method</article-title>. <source>Transl Clin Pharmacol</source>. <year>2015</year>;<volume>23</volume>:<fpage>1</fpage>.<pub-id pub-id-type="doi" assigning-authority="pmc">10.12793/tcp.2018.26.2.99</pub-id><pub-id pub-id-type="pmcid">PMC6989257</pub-id><pub-id pub-id-type="pmid">32055556</pub-id></mixed-citation></ref><ref id="psp412689-bib-0028"><label>28</label><mixed-citation publication-type="journal" id="psp412689-cit-0028"><string-name name-style="western"><surname>Bae</surname><given-names>K&#8208;S</given-names></string-name>, <string-name name-style="western"><surname>Yim</surname><given-names>D&#8208;S</given-names></string-name>. <article-title>R&#8208;based reproduction of the estimation process hidden behind NONMEM<sup>&#174;</sup> Part 2: First&#8208;order conditional estimation</article-title>. <source>Transl Clin Pharmacol</source>. <year>2016</year>;<volume>24</volume>:<fpage>161</fpage>.<pub-id pub-id-type="doi" assigning-authority="pmc">10.12793/tcp.2018.26.2.99</pub-id><pub-id pub-id-type="pmcid">PMC6989257</pub-id><pub-id pub-id-type="pmid">32055556</pub-id></mixed-citation></ref><ref id="psp412689-bib-0029"><label>29</label><mixed-citation publication-type="miscellaneous" id="psp412689-cit-0029"><article-title>Generate MAP Bayes parameter estimates</article-title>. <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://mrgsolve.github.io/blog/map_bayes.html" ext-link-type="uri">https://mrgsolve.github.io/blog/map_bayes.html</ext-link>. Accessed June 21, 2021.</mixed-citation></ref><ref id="psp412689-bib-0030"><label>30</label><mixed-citation publication-type="journal" id="psp412689-cit-0030"><string-name name-style="western"><surname>Bauer</surname><given-names>RJ</given-names></string-name>. <article-title>NONMEM tutorial part I: Description of commands and options, with simple examples of population analysis</article-title>. <source>CPT Pharmacometrics Syst Pharmacol</source>. <year>2019</year>;<volume>8</volume>:<fpage>525</fpage>&#8208;<lpage>537</lpage>.<pub-id pub-id-type="doi" assigning-authority="pmc">10.1002/psp4.12404</pub-id><pub-id pub-id-type="pmcid">PMC6709426</pub-id><pub-id pub-id-type="pmid">31056834</pub-id></mixed-citation></ref><ref id="psp412689-bib-0031"><label>31</label><mixed-citation publication-type="miscellaneous" id="psp412689-cit-0031"><string-name name-style="western"><surname>Nash</surname><given-names>JC</given-names></string-name>, <string-name name-style="western"><surname>Varadhan</surname><given-names>R</given-names></string-name>, <string-name name-style="western"><surname>Grothendieck</surname><given-names>G</given-names></string-name>. <article-title>optimx: expanded replacement and extension of the &#8220;optim&#8221; function</article-title>. <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://CRAN.R-project.org/package=optimx" ext-link-type="uri">https://CRAN.R&#8208;project.org/package=optimx</ext-link>. Published 2020. Accessed March 23, 2021.</mixed-citation></ref><ref id="psp412689-bib-0032"><label>32</label><mixed-citation publication-type="journal" id="psp412689-cit-0032"><string-name name-style="western"><surname>Moeung</surname><given-names>S</given-names></string-name>, <string-name name-style="western"><surname>Chevreau</surname><given-names>C</given-names></string-name>, <string-name name-style="western"><surname>Broutin</surname><given-names>S</given-names></string-name>, et al. <article-title>Therapeutic drug monitoring of carboplatin in high&#8208;dose protocol (TI&#8208;CE) for advanced germ cell tumors: Pharmacokinetic results of a phase II multicenter study</article-title>. <source>Clin Cancer Res</source>. <year>2017</year>;<volume>23</volume>:<fpage>7171</fpage>&#8208;<lpage>7179</lpage>.<pub-id pub-id-type="pmid">28928162</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1158/1078-0432.CCR-17-1344</pub-id></mixed-citation></ref><ref id="psp412689-bib-0033"><label>33</label><mixed-citation publication-type="journal" id="psp412689-cit-0033"><string-name name-style="western"><surname>Gallais</surname><given-names>F</given-names></string-name>, <string-name name-style="western"><surname>Ysebaert</surname><given-names>L</given-names></string-name>, <string-name name-style="western"><surname>Despas</surname><given-names>F</given-names></string-name>, et al. <article-title>Population pharmacokinetics of ibrutinib and its dihydrodiol metabolite in patients with lymphoid malignancies</article-title>. <source>Clin Pharmacokinet</source>. <year>2020</year>;<volume>59</volume>:<fpage>1171</fpage>&#8208;<lpage>1183</lpage>.<pub-id pub-id-type="pmid">32328976</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1007/s40262-020-00884-0</pub-id></mixed-citation></ref><ref id="psp412689-bib-0034"><label>34</label><mixed-citation publication-type="journal" id="psp412689-cit-0034"><string-name name-style="western"><surname>Le Louedec</surname><given-names>F</given-names></string-name>, <string-name name-style="western"><surname>Gallais</surname><given-names>F</given-names></string-name>, <string-name name-style="western"><surname>Thomas</surname><given-names>F</given-names></string-name>, et al. <article-title>Limited sampling strategy for determination of ibrutinib plasma exposure, Joint analyses with metabolite data</article-title>. <source>Pharmaceuticals (Basel)</source>. <year>2021</year>;<volume>14</volume>.<pub-id pub-id-type="doi" assigning-authority="pmc">10.3390/ph14020162</pub-id><pub-id pub-id-type="pmcid">PMC7922501</pub-id><pub-id pub-id-type="pmid">33670575</pub-id></mixed-citation></ref><ref id="psp412689-bib-0035"><label>35</label><mixed-citation publication-type="journal" id="psp412689-cit-0035"><string-name name-style="western"><surname>Nguyen</surname><given-names>L</given-names></string-name>, <string-name name-style="western"><surname>Chapel</surname><given-names>S</given-names></string-name>, <string-name name-style="western"><surname>Tran</surname><given-names>BD</given-names></string-name>, et al. <article-title>Updated population pharmacokinetic model of cabozantinib integrating various cancer types including hepatocellular carcinoma</article-title>. <source>J Clin Pharmacol</source>. <year>2019</year>;<volume>59</volume>:<fpage>1551</fpage>&#8208;<lpage>1561</lpage>.<pub-id pub-id-type="pmid">31187515</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1002/jcph.1467</pub-id><pub-id pub-id-type="pmcid">PMC6790584</pub-id></mixed-citation></ref><ref id="psp412689-bib-0036"><label>36</label><mixed-citation publication-type="journal" id="psp412689-cit-0036"><string-name name-style="western"><surname>Yu</surname><given-names>H</given-names></string-name>, <string-name name-style="western"><surname>van Erp</surname><given-names>N</given-names></string-name>, <string-name name-style="western"><surname>Bins</surname><given-names>S</given-names></string-name>, et al. <article-title>Development of a pharmacokinetic model to describe the complex pharmacokinetics of Pazopanib in cancer patients</article-title>. <source>Clin Pharmacokinet</source>. <year>2016</year>;<volume>56</volume>:<fpage>293</fpage>&#8208;<lpage>303</lpage>.<pub-id pub-id-type="doi" assigning-authority="pmc">10.1007/s40262-016-0443-y</pub-id><pub-id pub-id-type="pmid">27534647</pub-id></mixed-citation></ref><ref id="psp412689-bib-0037"><label>37</label><mixed-citation publication-type="journal" id="psp412689-cit-0037"><string-name name-style="western"><surname>Friberg</surname><given-names>LE</given-names></string-name>, <string-name name-style="western"><surname>Ravva</surname><given-names>P</given-names></string-name>, <string-name name-style="western"><surname>Karlsson</surname><given-names>MO</given-names></string-name>, et al. <article-title>Integrated population pharmacokinetic analysis of voriconazole in children, adolescents, and adults</article-title>. <source>Antimicrob Agents Chemother</source>. <year>2012</year>;<volume>56</volume>:<fpage>3032</fpage>&#8208;<lpage>3042</lpage>.<pub-id pub-id-type="pmid">22430956</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1128/AAC.05761-11</pub-id><pub-id pub-id-type="pmcid">PMC3370730</pub-id></mixed-citation></ref><ref id="psp412689-bib-0038"><label>38</label><mixed-citation publication-type="journal" id="psp412689-cit-0038"><string-name name-style="western"><surname>Yu</surname><given-names>H</given-names></string-name>, <string-name name-style="western"><surname>Steeghs</surname><given-names>N</given-names></string-name>, <string-name name-style="western"><surname>Kloth</surname><given-names>JSL</given-names></string-name>, et al. <article-title>Integrated semi&#8208;physiological pharmacokinetic model for both sunitinib and its active metabolite SU12662</article-title>. <source>Br J Clin Pharmacol</source>. <year>2015</year>;<volume>79</volume>:<fpage>809</fpage>&#8208;<lpage>819</lpage>.<pub-id pub-id-type="pmid">25393890</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1111/bcp.12550</pub-id><pub-id pub-id-type="pmcid">PMC4415717</pub-id></mixed-citation></ref><ref id="psp412689-bib-0039"><label>39</label><mixed-citation publication-type="journal" id="psp412689-cit-0039"><string-name name-style="western"><surname>Faltaos</surname><given-names>DW</given-names></string-name>, <string-name name-style="western"><surname>Hulot</surname><given-names>JS</given-names></string-name>, <string-name name-style="western"><surname>Urien</surname><given-names>S</given-names></string-name>, et al. <article-title>Population pharmacokinetic study of methotrexate in patients with lymphoid malignancy</article-title>. <source>Cancer Chemother Pharmacol</source>. <year>2006</year>;<volume>58</volume>:<fpage>626</fpage>&#8208;<lpage>633</lpage>.<pub-id pub-id-type="pmid">16528531</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1007/s00280-006-0202-0</pub-id></mixed-citation></ref><ref id="psp412689-bib-0040"><label>40</label><mixed-citation publication-type="journal" id="psp412689-cit-0040"><string-name name-style="western"><surname>Schoemaker</surname><given-names>R</given-names></string-name>, <string-name name-style="western"><surname>Fidler</surname><given-names>M</given-names></string-name>, <string-name name-style="western"><surname>Laveille</surname><given-names>C</given-names></string-name>, et al. <article-title>Performance of the SAEM and FOCEI algorithms in the open&#8208;source, nonlinear mixed effect modeling tool nlmixr</article-title>. <source>CPT Pharmacometrics Syst Pharmacol</source>. <year>2019</year>;<volume>8</volume>:<fpage>923</fpage>&#8208;<lpage>930</lpage>.<pub-id pub-id-type="pmid">31654482</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1002/psp4.12471</pub-id><pub-id pub-id-type="pmcid">PMC6930853</pub-id></mixed-citation></ref><ref id="psp412689-bib-0041"><label>41</label><mixed-citation publication-type="miscellaneous" id="psp412689-cit-0041"><article-title>GitHub</article-title>. <collab collab-type="authors">mrgsolve/nmtests</collab>
. <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/mrgsolve/nmtests" ext-link-type="uri">https://github.com/mrgsolve/nmtests</ext-link>. Accessed June 21, 2021.</mixed-citation></ref><ref id="psp412689-bib-0042"><label>42</label><mixed-citation publication-type="journal" id="psp412689-cit-0042"><string-name name-style="western"><surname>van der Meer</surname><given-names>AF</given-names></string-name>, <string-name name-style="western"><surname>Marcus</surname><given-names>MAE</given-names></string-name>, <string-name name-style="western"><surname>Touw</surname><given-names>DJ</given-names></string-name>, et al. <article-title>Optimal sampling strategy development methodology using maximum A posteriori Bayesian estimation</article-title>. <source>Ther Drug Monit</source>. <year>2011</year>;<volume>33</volume>:<fpage>133</fpage>&#8208;<lpage>146</lpage>.<pub-id pub-id-type="pmid">21383653</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1097/FTD.0b013e31820f40f8</pub-id></mixed-citation></ref><ref id="psp412689-bib-0043"><label>43</label><mixed-citation publication-type="journal" id="psp412689-cit-0043"><string-name name-style="western"><surname>Savic</surname><given-names>RM</given-names></string-name>, <string-name name-style="western"><surname>Karlsson</surname><given-names>MO</given-names></string-name>. <article-title>Importance of shrinkage in empirical bayes estimates for diagnostics: problems and solutions</article-title>. <source>AAPS J</source>. <year>2009</year>;<volume>11</volume>:<fpage>558</fpage>&#8208;<lpage>569</lpage>.<pub-id pub-id-type="pmid">19649712</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1208/s12248-009-9133-0</pub-id><pub-id pub-id-type="pmcid">PMC2758126</pub-id></mixed-citation></ref><ref id="psp412689-bib-0044"><label>44</label><mixed-citation publication-type="journal" id="psp412689-cit-0044"><string-name name-style="western"><surname>Dumont</surname><given-names>C</given-names></string-name>, <string-name name-style="western"><surname>Lestini</surname><given-names>G</given-names></string-name>, <string-name name-style="western"><surname>Le Nagard</surname><given-names>H</given-names></string-name>, et al. <article-title>PFIM 4.0, an extended R program for design evaluation and optimization in nonlinear mixed&#8208;effect models</article-title>. <source>Comput Methods Programs Biomed</source>. <year>2018</year>;<volume>156</volume>:<fpage>217</fpage>&#8208;<lpage>229</lpage>.<pub-id pub-id-type="pmid">29428073</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1016/j.cmpb.2018.01.008</pub-id></mixed-citation></ref><ref id="psp412689-bib-0045"><label>45</label><mixed-citation publication-type="journal" id="psp412689-cit-0045"><string-name name-style="western"><surname>Nyberg</surname><given-names>J</given-names></string-name>, <string-name name-style="western"><surname>Ueckert</surname><given-names>S</given-names></string-name>, <string-name name-style="western"><surname>Str&#246;mberg</surname><given-names>EA</given-names></string-name>, et al. <article-title>PopED: an extended, parallelized, nonlinear mixed effects models optimal design tool</article-title>. <source>Comput Methods Programs Biomed</source>. <year>2012</year>;<volume>108</volume>:<fpage>789</fpage>&#8208;<lpage>805</lpage>.<pub-id pub-id-type="pmid">22640817</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1016/j.cmpb.2012.05.005</pub-id></mixed-citation></ref><ref id="psp412689-bib-0046"><label>46</label><mixed-citation publication-type="journal" id="psp412689-cit-0046"><string-name name-style="western"><surname>Kluwe</surname><given-names>F</given-names></string-name>, <string-name name-style="western"><surname>Michelet</surname><given-names>R</given-names></string-name>, <string-name name-style="western"><surname>Mueller&#8208;Schoell</surname><given-names>A</given-names></string-name>, et al. <article-title>Perspectives on model&#8208;informed precision dosing in the digital health era: challenges, opportunities, and recommendations</article-title>. <source>Clin Pharmacol Ther</source>. <year>2021</year>;<volume>109</volume>:<fpage>29</fpage>&#8208;<lpage>36</lpage>.<pub-id pub-id-type="pmid">33068303</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1002/cpt.2049</pub-id></mixed-citation></ref><ref id="psp412689-bib-0047"><label>47</label><mixed-citation publication-type="journal" id="psp412689-cit-0047"><string-name name-style="western"><surname>Leenhardt</surname><given-names>F</given-names></string-name>, <string-name name-style="western"><surname>Viala</surname><given-names>M</given-names></string-name>, <string-name name-style="western"><surname>Tosi</surname><given-names>D</given-names></string-name>, et al. <article-title>Therapeutic Bayesian monitoring of sunitinib in two patients with impaired absorption or elimination</article-title>. <source>J Clin Pharm Ther</source>. <year>2021</year>;<volume>46</volume>(<issue>4</issue>):<fpage>1182</fpage>&#8208;<lpage>1184</lpage>.<pub-id pub-id-type="pmid">33821517</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1111/jcpt.13424</pub-id></mixed-citation></ref><ref id="psp412689-bib-0048"><label>48</label><mixed-citation publication-type="journal" id="psp412689-cit-0048"><string-name name-style="western"><surname>Maier</surname><given-names>C</given-names></string-name>, <string-name name-style="western"><surname>Hartung</surname><given-names>N</given-names></string-name>, <string-name name-style="western"><surname>Wiljes</surname><given-names>J</given-names></string-name>, et al. <article-title>Bayesian data assimilation to support informed decision making in individualized chemotherapy</article-title>. <source>CPT Pharmacometrics Syst Pharmacol</source>. <year>2020</year>;<volume>9</volume>:<fpage>153</fpage>&#8208;<lpage>164</lpage>.<pub-id pub-id-type="pmid">31905420</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1002/psp4.12492</pub-id><pub-id pub-id-type="pmcid">PMC7080550</pub-id></mixed-citation></ref></ref-list></back></article></pmc-articleset>